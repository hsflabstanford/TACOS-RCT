# data cleaning

# libraries
options(scipen = 99, digits = 4)
library(dplyr, warn.conflicts = F)
library(estimatr)
library(stringr)
library(tidyr)

# raw dat with a few small-bore manual fixes for respondents whose surveys glitched
raw_dat <- read.csv('./data/TACOS-data.csv')
label_data_set <- read.csv('./data/labeled_data.csv')
# few small bore fixes for a few people who gave impossible or wrong amswers
start_col <- which(names(raw_dat) == "cty_ak_v2_929bd2")
end_col <- ncol(raw_dat)

# a few quick cleaning things based on data errors
dat <- raw_dat |> select(-redcap_survey_identifier) |> 
  filter(redcap_event_name != 'consent_august_202_arm_1') |>
  mutate(cty_mn_v2_a6b8c9 = 
           if_else(record_id == 4070, NA, cty_mn_v2_a6b8c9),
         cty_ill_v2_09efc4 = if_else(record_id == 6421, 101, cty_ill_v2_09efc4),
         cty_pa_v2_73e5b9 = if_else(record_id == 4070, 101, cty_pa_v2_73e5b9)) |> 
  mutate(across(all_of(names(raw_dat)[start_col:end_col]), 
                ~ if_else(record_id %in% c(4422, 1790), NA, .))) 
# (record id = 4422 said they were from alabama, Idaho, puerto rico, 
# outlying islands (I think), and the virgin islands
# 1790 filled out three attention checks somehow

# main outcome vars and primary controls
  dat <- dat |>
  # Create treatment_arm 
  # Arm 2 -- veggies and Sofritas ; Arm 3 is Veggies, sofritas and Chiken'itas;
  # Arm 5 Group 5 is Arm 1 (control)
  mutate(treatment_arm = as.factor(case_when(
    str_detect(redcap_event_name, "arm_2") ~ 2,
    str_detect(redcap_event_name, "arm_3") ~ 3,
    str_detect(redcap_event_name, "arm_5") ~ 1))) |>
  ungroup() |>
  mutate(state = if_else(state == "", NA_character_, state),
         # main protein vars
         merged_protein = coalesce(protein_1, protein_2, protein_3),
         taco_choice = case_when(
           merged_protein == 1 ~ 'Chicken',
           merged_protein == 2 ~ 'Steak',
           merged_protein == 3 ~ 'Beef barbacoa',
           merged_protein == 4 ~ 'Carnitas',
           merged_protein == 5 ~ 'Sofritas (plant-based protein)',
           merged_protein == 6 ~ "Chick'nitas (plant-based protein)",
           merged_protein == 7 ~ 'Veggies (includes guacamole)', 
           merged_protein == 97 ~ 'I would not order any of these fillings.'), 
         meat_select = case_when(
           merged_protein %in% c(1, 2, 3, 4) ~ 1,
           merged_protein %in% c(5, 6, 7) ~ 0,
           merged_protein == 97 ~ NA),
         # Remove the early chicken_select definition here
         age = 2025 - dob,
         gender = case_when(
           gender == 1 ~ 'Female',
           gender == 2 ~ 'Male',
           TRUE ~ NA_character_),
         chicken_select = as.numeric(taco_choice == "Chicken"),
         other_meat_select = as.numeric(taco_choice %in% c("Beef barbacoa", "Carnitas", "Steak")))

# block order
# Fixed code for properly categorizing block orders
dat <- dat |>
  # First create a single block_order variable if you haven't already
  mutate(
    # Convert empty strings to NA before coalescing
    block_order_1 = na_if(block_order_1, ""),
    block_order_2 = na_if(block_order_2, ""),
    block_order_3 = na_if(block_order_3, ""),
    
    # Get the non-NA value
    block_order = coalesce(block_order_1, block_order_2, block_order_3)
  ) |>
  # Then create the corrected block_order_pre_tacos variable
  mutate(
    block_order_pre_tacos = case_when(
      # Pen-Shirt-Taco pattern - check each version
      block_order %in% c(
        "q_pen_instruct_1+pen_color_1+pen_tip_1+pen_paper_1-shirt_style_1+q_shirt_color_1+shirt_size_1+shirt_material_1-q_tacos_1+protein_1+tortilla_1+topp_1+addons_1+bev_1",
        "q_pen_instruct_2+pen_color_2+pen_tip_2+pen_paper_2-shirt_style_2+q_shirt_color_2+shirt_size_2+shirt_material_2-q_tacos_2+protein_2+tortilla_2+topp_2+addons_2+bev_2",
        "q_pen_instruct+pen_color+pen_tip+pen_paper-shirt_style+q_shirt_color+shirt_size+shirt_material-q_tacos+protein_3+tortilla+topp+addons+bev"
      ) ~ "Pen-Shirt",
      
      # Shirt-Pen-Taco pattern - check each version
      block_order %in% c(
        "shirt_style_1+q_shirt_color_1+shirt_size_1+shirt_material_1-q_pen_instruct_1+pen_color_1+pen_tip_1+pen_paper_1-q_tacos_1+protein_1+tortilla_1+topp_1+addons_1+bev_1",
        "shirt_style_2+q_shirt_color_2+shirt_size_2+shirt_material_2-q_pen_instruct_2+pen_color_2+pen_tip_2+pen_paper_2-q_tacos_2+protein_2+tortilla_2+topp_2+addons_2+bev_2",
        "shirt_style+q_shirt_color+shirt_size+shirt_material-q_pen_instruct+pen_color+pen_tip+pen_paper-q_tacos+protein_3+tortilla+topp+addons+bev"
      ) ~ "Shirt-Pen",
      
      # Pen-Taco-Shirt pattern - check each version
      block_order %in% c(
        "q_pen_instruct_1+pen_color_1+pen_tip_1+pen_paper_1-q_tacos_1+protein_1+tortilla_1+topp_1+addons_1+bev_1-shirt_style_1+q_shirt_color_1+shirt_size_1+shirt_material_1",
        "q_pen_instruct_2+pen_color_2+pen_tip_2+pen_paper_2-q_tacos_2+protein_2+tortilla_2+topp_2+addons_2+bev_2-shirt_style_2+q_shirt_color_2+shirt_size_2+shirt_material_2",
        "q_pen_instruct+pen_color+pen_tip+pen_paper-q_tacos+protein_3+tortilla+topp+addons+bev-shirt_style+q_shirt_color+shirt_size+shirt_material"
      ) ~ "Pen",
      
      # Shirt-Taco-Pen pattern - check each version 
      block_order %in% c(
        "shirt_style_1+q_shirt_color_1+shirt_size_1+shirt_material_1-q_tacos_1+protein_1+tortilla_1+topp_1+addons_1+bev_1-q_pen_instruct_1+pen_color_1+pen_tip_1+pen_paper_1",
        "shirt_style_2+q_shirt_color_2+shirt_size_2+shirt_material_2-q_tacos_2+protein_2+tortilla_2+topp_2+addons_2+bev_2-q_pen_instruct_2+pen_color_2+pen_tip_2+pen_paper_2",
        "shirt_style+q_shirt_color+shirt_size+shirt_material-q_tacos+protein_3+tortilla+topp+addons+bev-q_pen_instruct+pen_color+pen_tip+pen_paper"
      ) ~ "Shirt",
      
      # Taco-Pen-Shirt or Taco-Shirt-Pen pattern - all versions that start with tacos
      str_detect(block_order, "^q_tacos") ~ "None",
      
      # Default case
      TRUE ~ NA_character_
    ),
    # Convert to factor with meaningful order
    block_order_pre_tacos = factor(
      block_order_pre_tacos,
      levels = c("None", "Pen", "Shirt", "Pen-Shirt", "Shirt-Pen"))) |> 
  select(-c(block_order_1, block_order_2, block_order_3))

dat <-dat |> mutate( # beverage
    bev_code = coalesce(bev, bev_1, bev_2),
    bev_type = case_when(
      bev_code == 1 ~ "Organic watermelon limeade",
      bev_code == 2 ~ "Organic lemonade", 
      bev_code == 3 ~ "Organic mandarin agua fresca",
      bev_code == 4 ~ "Organic berry agua fresca",
      bev_code == 5 ~ "Fountain drink",
      bev_code == 6 ~ "Mexican Coca-Cola",
      bev_code == 7 ~ "Mexican Sprite",
      bev_code == 8 ~ "San Pellegrino sparkling",
      bev_code == 9 ~ "Grapefruit Izze",
      bev_code == 10 ~ "Blackberry Izze",
      bev_code == 11 ~ "Tractor organic lemonade",
      bev_code == 12 ~ "Apple juice",
      bev_code == 13 ~ "Tractor organic black tea",
      bev_code == 14 ~ "Bottled water",
      bev_code == 97 ~ "No beverage",
      TRUE ~ NA_character_
    ),
    .keep = "unused") |>  
  select(-bev_code)

# awareness check
dat <- dat |>
  mutate( # q_awareness
    purpose_guess = case_when(
      q_awareness == 1 ~ "Learning how many color options to provide across different products",
      q_awareness == 3 ~ "Learning whether people's shirt preferences are related to their food preferences",
      q_awareness == 4 ~ "Learning how solid color options affect the shirts people choose",
      q_awareness == 5 ~ "Learning how plant-based protein options affect the foods people choose",
      q_awareness == 7 ~ "Learning how fine-point pen options affect the type of paper people choose",
      q_awareness == 9 ~ "Learning how t-shirt size is related to beverage preference",
      q_awareness == 11 ~ "Learning whether older people are more likely to select high calorie toppings",
      q_awareness == 13 ~ "Learning how color preference relates to food preference",
      TRUE ~ NA_character_), .keep = "unused") |>
  mutate(
    education = case_when(
      edu == 1 ~ "8th grade or less",
      edu == 2 ~ "Some high school, but did not graduate",
      edu == 3 ~ "High school or GED",
      edu == 4 ~ "Some college or 2-year degree",
      edu == 5 ~ "4-year college graduate",
      edu == 6 ~ "More than 4-year college degree",
      TRUE ~ NA_character_),
    .keep = "unused") |>
  mutate(
    # First count the number of ethnicities selected
    ethnicity_count = rowSums(across(starts_with("eth___"), ~!is.na(.) & . == 1), na.rm = TRUE),
    black = eth___1 == 1, # Create individual ethnicity indicators
    caucasian = eth___2 == 1,
    east_asian = eth___3 == 1,
    hispanic = eth___4 == 1,
    middle_eastern = eth___5 == 1,
    native_american = eth___6 == 1,
    pacific_islander = eth___7 == 1,
    south_asian = eth___8 == 1,
    southeast_asian = eth___9 == 1,
    other_eth = eth___99 == 1,
    ethnicity = case_when( # Create  ethnicity string
      # Single ethnicity cases
      ethnicity_count == 1 & black ~ "Black/African American",
      ethnicity_count == 1 & caucasian ~ "Caucasian",
      ethnicity_count == 1 & east_asian ~ "East Asian",
      ethnicity_count == 1 & hispanic ~ "Hispanic",
      ethnicity_count == 1 & middle_eastern ~ "Middle Eastern",
      ethnicity_count == 1 & native_american ~ "Native American",
      ethnicity_count == 1 & pacific_islander ~ "Pacific Islander",
      ethnicity_count == 1 & south_asian ~ "South Asian",
      ethnicity_count == 1 & southeast_asian ~ "Southeast Asian",
      ethnicity_count == 1 & other_eth ~ "Other",
      # Multi ethnicity case - specific common combinations
      black & caucasian ~ "Multi: Black/African American + Caucasian",
      caucasian & hispanic ~ "Multi: Caucasian + Hispanic",
      caucasian & native_american ~ "Multi: Caucasian + Native American",
      caucasian & east_asian ~ "Multi: Caucasian + East Asian",
      black & hispanic ~ "Multi: Black/African American + Hispanic",
      # Generic multi-ethnicity case
      ethnicity_count > 1 ~ "Multi-ethnic",
      # Default case
      TRUE ~ NA_character_),
    .keep = "unused") |>
  mutate(attention_check = coalesce(protein_1_attn, protein_2_attn, protein_3_attn),
         .keep = "unused") |>
  mutate(tortilla_code = coalesce(tortilla, tortilla_1, tortilla_2), .keep = "unused") |>
  mutate(tortilla_type = case_when(
  tortilla_code == 1 ~ "Crispy corn tortillas",
  tortilla_code == 2 ~ "Soft flour tortillas",
  tortilla_code == 97 ~ "No tortillas",
  TRUE ~ NA_character_), 
  .keep = "unused") |>
  mutate(      # Regular toppings
    no_toppings = rowSums(cbind(topp___98, topp_1___98, topp_2___98), na.rm = TRUE) > 0,
    white_rice = rowSums(cbind(topp___1, topp_1___1, topp_2___1), na.rm = TRUE) > 0,
    brown_rice = rowSums(cbind(topp___2, topp_1___2, topp_2___2), na.rm = TRUE) > 0,
    black_beans = rowSums(cbind(topp___3, topp_1___3, topp_2___3), na.rm = TRUE) > 0,
    pinto_beans = rowSums(cbind(topp___4, topp_1___4, topp_2___4), na.rm = TRUE) > 0,
    fresh_tomato_salsa = rowSums(cbind(topp___5, topp_1___5, topp_2___5), na.rm = TRUE) > 0,
    roasted_chili_corn = rowSums(cbind(topp___6, topp_1___6, topp_2___6), na.rm = TRUE) > 0,
    tomatillo_green = rowSums(cbind(topp___7, topp_1___7, topp_2___7), na.rm = TRUE) > 0,
    tomatillo_red = rowSums(cbind(topp___8, topp_1___8, topp_2___8), na.rm = TRUE) > 0,
    sour_cream = rowSums(cbind(topp___9, topp_1___9, topp_2___9), na.rm = TRUE) > 0,
    fajita_veggies = rowSums(cbind(topp___10, topp_1___10, topp_2___10), na.rm = TRUE) > 0,
    cheese = rowSums(cbind(topp___11, topp_1___11, topp_2___11), na.rm = TRUE) > 0,
    romaine_lettuce = rowSums(cbind(topp___12, topp_1___12, topp_2___12), na.rm = TRUE) > 0,
    has_dairy = case_when(
      topp_1___10 == 1 | topp_2___10 == 1 | topp___10 == 1 |
        topp_1___9 == 1 | topp_2___9 == 1 | topp___9 == 1 |
        addons_1___2 == 1 | addons_2___2 == 1 | addons___2 == 1 ~ TRUE,
      TRUE ~ FALSE),
    # Regular toppings summary
    regular_toppings = case_when(
      no_toppings ~ "No toppings",
      TRUE ~ paste0(
        if_else(white_rice, "White rice", ""),
        if_else(white_rice & (brown_rice | black_beans | pinto_beans |
                                fresh_tomato_salsa | roasted_chili_corn |
                                tomatillo_green | tomatillo_red | sour_cream |
                                fajita_veggies | cheese | romaine_lettuce),
                " + ", ""),
        if_else(brown_rice, "Brown rice", ""),
        if_else(brown_rice & (black_beans | pinto_beans |
                                fresh_tomato_salsa | roasted_chili_corn |
                                tomatillo_green | tomatillo_red |
                                sour_cream | fajita_veggies | cheese |
                                romaine_lettuce),
                " + ", ""),
        if_else(black_beans, "Black beans", ""),
        if_else(black_beans & (pinto_beans | fresh_tomato_salsa |
                                 roasted_chili_corn | tomatillo_green |
                                 tomatillo_red | sour_cream | fajita_veggies |
                                 cheese | romaine_lettuce), " + ", ""),
        if_else(pinto_beans, "Pinto beans", ""),
        if_else(pinto_beans & (fresh_tomato_salsa | roasted_chili_corn |
                                 tomatillo_green | tomatillo_red |
                                 sour_cream | fajita_veggies | cheese |
                                 romaine_lettuce),
                " + ", ""),
        if_else(fresh_tomato_salsa, "Fresh tomato salsa", ""),
        if_else(fresh_tomato_salsa & (roasted_chili_corn |
                                        tomatillo_green | tomatillo_red |
                                        sour_cream | fajita_veggies |
                                        cheese | romaine_lettuce),
                " + ", ""),
        if_else(roasted_chili_corn, "Roasted chili corn salsa", ""),
        if_else(roasted_chili_corn & (tomatillo_green | tomatillo_red |
                                        sour_cream | fajita_veggies |
                                        cheese | romaine_lettuce),
                " + ", ""),
        if_else(tomatillo_green, "Tomatillo green chili salsa", ""),
        if_else(tomatillo_green & (tomatillo_red | sour_cream | fajita_veggies |
                                     cheese | romaine_lettuce),
                " + ", ""),
        if_else(tomatillo_red, "Tomatillo red chili salsa", ""),
        if_else(tomatillo_red & (sour_cream | fajita_veggies | cheese |
                                   romaine_lettuce),
                " + ", ""),
        if_else(sour_cream, "Sour cream", ""),
        if_else(sour_cream & (fajita_veggies | cheese | romaine_lettuce),
                " + ", ""),
        if_else(fajita_veggies, "Fajita veggies", ""),
        if_else(fajita_veggies & (cheese | romaine_lettuce), " + ", ""),
        if_else(cheese, "Cheese", ""),
        if_else(cheese & romaine_lettuce, " + ", ""),
        if_else(romaine_lettuce, "Romaine lettuce", ""))),
    # Premium toppings
    no_premium = rowSums(cbind(addons___97, addons_1___97, addons_2___97), na.rm = TRUE) > 0,
    guacamole = rowSums(cbind(addons___1, addons_1___1, addons_2___1), na.rm = TRUE) > 0,
    queso_blanco = rowSums(cbind(addons___2, addons_1___2, addons_2___2), na.rm = TRUE) > 0) |>
    mutate(
    # Premium toppings summary
      premium_toppings = case_when(
      no_premium ~ "No premium toppings",
      TRUE ~ paste0(
        if_else(guacamole, "Guacamole", ""),
        if_else(guacamole & queso_blanco, " + ", ""),
        if_else(queso_blanco, "Queso blanco", ""))), .keep = "unused") |>
  select(-c(ethnicity_count, black, caucasian, east_asian, hispanic,
            middle_eastern, native_american, pacific_islander, south_asian, 
            southeast_asian, other_eth)) |> 
  mutate( # political affiliation
    political_party = case_when(
      polit == 1 ~ "Democrat",
      polit == 2 ~ "Independent",
      polit == 3 ~ "Republican",
      polit == 9 ~ "Other",
      polit == 99 ~ "Prefer not to answer",
      TRUE ~ NA_character_),
    .keep = "unused") |>
  rename(times_visited_chipotle_past_month = chip) |>
  mutate( # opting out of picking a taco
    opted_out_all = case_when(
      opted_out_all == 80 ~ "My preferred meal would be something vegetarian",
      opted_out_all == 81 ~ "My preferred meal would be something with chicken",
      opted_out_all == 82 ~ "My preferred meal would be something with beef",
      opted_out_all == 89 ~ "My preferred meal would be something with a different kind of meat",
      TRUE ~ NA_character_), .keep = 'unused') |>
    mutate(
      county_al = case_when(
        cty_al_v2_e22628 == 1 ~ "Autauga",
        cty_al_v2_e22628 == 2 ~ "Baldwin",
        cty_al_v2_e22628 == 5 ~ "Blount",
        cty_al_v2_e22628 == 8 ~ "Calhoun",
        cty_al_v2_e22628 == 16 ~ "Coffee",
        cty_al_v2_e22628 == 18 ~ "Conecuh",
        cty_al_v2_e22628 == 24 ~ "Dallas",
        cty_al_v2_e22628 == 25 ~ "DeKalb",
        cty_al_v2_e22628 == 28 ~ "Etowah",
        cty_al_v2_e22628 == 33 ~ "Hale",
        cty_al_v2_e22628 == 36 ~ "Jackson",
        cty_al_v2_e22628 == 37 ~ "Jefferson",
        cty_al_v2_e22628 == 39 ~ "Lauderdale",
        cty_al_v2_e22628 == 41 ~ "Lee",
        cty_al_v2_e22628 == 42 ~ "Limestone",
        cty_al_v2_e22628 == 43 ~ "Lowndes",
        cty_al_v2_e22628 == 45 ~ "Madison",
        cty_al_v2_e22628 == 48 ~ "Marshall",
        cty_al_v2_e22628 == 49 ~ "Mobile",
        cty_al_v2_e22628 == 51 ~ "Montgomery",
        cty_al_v2_e22628 == 52 ~ "Morgan",
        cty_al_v2_e22628 == 57 ~ "Russell",
        cty_al_v2_e22628 == 58 ~ "Shelby",
        cty_al_v2_e22628 == 59 ~ "St. Clair",
        cty_al_v2_e22628 == 61 ~ "Talladega",
        cty_al_v2_e22628 == 62 ~ "Tallapoosa",
        cty_al_v2_e22628 == 63 ~ "Tuscaloosa",
        cty_al_v2_e22628 == 64 ~ "Walker",
        cty_al_v2_e22628 == 65 ~ "Washington",
        TRUE ~ NA_character_),
      county_ak = case_when(
        cty_ak_v2_929bd2 == 3 ~ "Anchorage Municipality (02020)",
        cty_ak_v2_929bd2 == 71 ~ "Juneau City and Borough (02110)",
        cty_ak_v2_929bd2 == 72 ~ "Kenai Peninsula Borough (02122)",
        cty_ak_v2_929bd2 == 77 ~ "Matanuska-Susitna Borough (02170)",
        TRUE ~ NA_character_),
      county_az = case_when(
        cty_az_v2_b780e3 == 1 ~ "Apache",
        cty_az_v2_b780e3 == 2 ~ "Cochise",
        cty_az_v2_b780e3 == 68 ~ "Graham",
        cty_az_v2_b780e3 == 69 ~ "Greenlee",
        cty_az_v2_b780e3 == 71 ~ "Maricopa",
        cty_az_v2_b780e3 == 72 ~ "Mohave",
        cty_az_v2_b780e3 == 74 ~ "Pima",
        cty_az_v2_b780e3 == 75 ~ "Pinal",
        TRUE ~ NA_character_),
      county_ark = case_when(
        cty_ark_v2_955bdf == 1 ~ "Arkansas",
        cty_ark_v2_955bdf == 80 ~ "Baxter",
        cty_ark_v2_955bdf == 81 ~ "Benton",
        cty_ark_v2_955bdf == 82 ~ "Boone",
        cty_ark_v2_955bdf == 86 ~ "Chicot",
        cty_ark_v2_955bdf == 100 ~ "Faulkner",
        cty_ark_v2_955bdf == 101 ~ "Franklin",
        cty_ark_v2_955bdf == 103 ~ "Garland",
        cty_ark_v2_955bdf == 109 ~ "Independence",
        cty_ark_v2_955bdf == 118 ~ "Little River",
        cty_ark_v2_955bdf == 126 ~ "Montgomery",
        cty_ark_v2_955bdf == 137 ~ "Pulaski",
        cty_ark_v2_955bdf == 139 ~ "Saline",
        cty_ark_v2_955bdf == 141 ~ "Searcy",
        cty_ark_v2_955bdf == 148 ~ "Van Buren",
        TRUE ~ NA_character_),
      county_ca = case_when(
        cty_ca_v2_74012e == 1 ~ "Alameda",
        cty_ca_v2_74012e == 154 ~ "Amador",
        cty_ca_v2_74012e == 155 ~ "Butte",
        cty_ca_v2_74012e == 156 ~ "Calaveras",
        cty_ca_v2_74012e == 158 ~ "Contra Costa",
        cty_ca_v2_74012e == 159 ~ "Del Norte",
        cty_ca_v2_74012e == 160 ~ "El Dorado",
        cty_ca_v2_74012e == 161 ~ "Fresno",
        cty_ca_v2_74012e == 163 ~ "Humboldt",
        cty_ca_v2_74012e == 164 ~ "Imperial",
        cty_ca_v2_74012e == 166 ~ "Kern",
        cty_ca_v2_74012e == 167 ~ "Kings",
        cty_ca_v2_74012e == 169 ~ "Lassen",
        cty_ca_v2_74012e == 170 ~ "Los Angeles",
        cty_ca_v2_74012e == 171 ~ "Madera",
        cty_ca_v2_74012e == 174 ~ "Mendocino",
        cty_ca_v2_74012e == 175 ~ "Merced",
        cty_ca_v2_74012e == 178 ~ "Monterey",
        cty_ca_v2_74012e == 179 ~ "Napa",
        cty_ca_v2_74012e == 180 ~ "Nevada",
        cty_ca_v2_74012e == 181 ~ "Orange",
        cty_ca_v2_74012e == 182 ~ "Placer",
        cty_ca_v2_74012e == 184 ~ "Riverside",
        cty_ca_v2_74012e == 185 ~ "Sacramento",
        cty_ca_v2_74012e == 187 ~ "San Bernardino",
        cty_ca_v2_74012e == 188 ~ "San Diego",
        cty_ca_v2_74012e == 189 ~ "San Francisco",
        cty_ca_v2_74012e == 190 ~ "San Joaquin",
        cty_ca_v2_74012e == 191 ~ "San Luis Obispo",
        cty_ca_v2_74012e == 192 ~ "San Mateo",
        cty_ca_v2_74012e == 193 ~ "Santa Barbara",
        cty_ca_v2_74012e == 194 ~ "Santa Clara",
        cty_ca_v2_74012e == 195 ~ "Santa Cruz",
        cty_ca_v2_74012e == 196 ~ "Shasta",
        cty_ca_v2_74012e == 199 ~ "Solano",
        cty_ca_v2_74012e == 200 ~ "Sonoma",
        cty_ca_v2_74012e == 201 ~ "Stanislaus",
        cty_ca_v2_74012e == 202 ~ "Sutter",
        cty_ca_v2_74012e == 205 ~ "Tulare",
        cty_ca_v2_74012e == 207 ~ "Ventura",
        cty_ca_v2_74012e == 208 ~ "Yolo",
        cty_ca_v2_74012e == 209 ~ "Yuba",
        TRUE ~ NA_character_),
      county_col = case_when(
        cty_col_v2_143aa2 == 1 ~ "Adams",
        cty_col_v2_143aa2 == 3 ~ "Arapahoe",
        cty_col_v2_143aa2 == 7 ~ "Boulder",
        cty_col_v2_143aa2 == 9 ~ "Chaffee",
        cty_col_v2_143aa2 == 12 ~ "Conejos",
        cty_col_v2_143aa2 == 16 ~ "Delta",
        cty_col_v2_143aa2 == 17 ~ "Denver",
        cty_col_v2_143aa2 == 19 ~ "Douglas",
        cty_col_v2_143aa2 == 21 ~ "El Paso",
        cty_col_v2_143aa2 == 22 ~ "Elbert",
        cty_col_v2_143aa2 == 23 ~ "Fremont",
        cty_col_v2_143aa2 == 24 ~ "Garfield",
        cty_col_v2_143aa2 == 31 ~ "Jefferson",
        cty_col_v2_143aa2 == 36 ~ "Larimer",
        cty_col_v2_143aa2 == 40 ~ "Mesa",
        cty_col_v2_143aa2 == 44 ~ "Montrose",
        cty_col_v2_143aa2 == 52 ~ "Pueblo",
        cty_col_v2_143aa2 == 63 ~ "Weld",
        TRUE ~ NA_character_),
      county_ct = case_when(
        cty_ct_v2_8af58b == 2 ~ "Fairfield",
        cty_ct_v2_8af58b == 4 ~ "Hartford",
        cty_ct_v2_8af58b == 5 ~ "Litchfield",
        cty_ct_v2_8af58b == 7 ~ "Middlesex",
        cty_ct_v2_8af58b == 9 ~ "New Haven",
        cty_ct_v2_8af58b == 10 ~ "New London",
        cty_ct_v2_8af58b == 15 ~ "Tolland",
        cty_ct_v2_8af58b == 17 ~ "Windham",
        TRUE ~ NA_character_),
      
      county_de = case_when(
        cty_de_v2_77b4ae == 1 ~ "Kent",
        cty_de_v2_77b4ae == 2 ~ "New Castle",
        cty_de_v2_77b4ae == 3 ~ "Sussex",
        TRUE ~ NA_character_),
      county_fla = case_when(
        cty_fla_v2_6e16f0 == 1 ~ "Alachua",
        cty_fla_v2_6e16f0 == 3 ~ "Bay",
        cty_fla_v2_6e16f0 == 4 ~ "Bradford",
        cty_fla_v2_6e16f0 == 5 ~ "Brevard",
        cty_fla_v2_6e16f0 == 6 ~ "Broward",
        cty_fla_v2_6e16f0 == 8 ~ "Charlotte",
        cty_fla_v2_6e16f0 == 9 ~ "Citrus",
        cty_fla_v2_6e16f0 == 10 ~ "Clay",
        cty_fla_v2_6e16f0 == 12 ~ "Columbia",
        cty_fla_v2_6e16f0 == 13 ~ "DeSoto",
        cty_fla_v2_6e16f0 == 15 ~ "Duval",
        cty_fla_v2_6e16f0 == 16 ~ "Escambia",
        cty_fla_v2_6e16f0 == 17 ~ "Flagler",
        cty_fla_v2_6e16f0 == 19 ~ "Gadsden",
        cty_fla_v2_6e16f0 == 23 ~ "Hamilton",
        cty_fla_v2_6e16f0 == 25 ~ "Hendry",
        cty_fla_v2_6e16f0 == 26 ~ "Hernando",
        cty_fla_v2_6e16f0 == 28 ~ "Hillsborough",
        cty_fla_v2_6e16f0 == 29 ~ "Holmes",
        cty_fla_v2_6e16f0 == 30 ~ "Indian River",
        cty_fla_v2_6e16f0 == 31 ~ "Jackson",
        cty_fla_v2_6e16f0 == 34 ~ "Lake",
        cty_fla_v2_6e16f0 == 35 ~ "Lee",
        cty_fla_v2_6e16f0 == 36 ~ "Leon",
        cty_fla_v2_6e16f0 == 37 ~ "Levy",
        cty_fla_v2_6e16f0 == 40 ~ "Manatee",
        cty_fla_v2_6e16f0 == 41 ~ "Marion",
        cty_fla_v2_6e16f0 == 42 ~ "Martin",
        cty_fla_v2_6e16f0 == 43 ~ "Miami-Dade",
        cty_fla_v2_6e16f0 == 44 ~ "Monroe",
        cty_fla_v2_6e16f0 == 46 ~ "Okaloosa",
        cty_fla_v2_6e16f0 == 48 ~ "Orange",
        cty_fla_v2_6e16f0 == 49 ~ "Osceola",
        cty_fla_v2_6e16f0 == 50 ~ "Palm Beach",
        cty_fla_v2_6e16f0 == 51 ~ "Pasco",
        cty_fla_v2_6e16f0 == 52 ~ "Pinellas",
        cty_fla_v2_6e16f0 == 53 ~ "Polk",
        cty_fla_v2_6e16f0 == 55 ~ "Santa Rosa",
        cty_fla_v2_6e16f0 == 56 ~ "Sarasota",
        cty_fla_v2_6e16f0 == 57 ~ "Seminole",
        cty_fla_v2_6e16f0 == 58 ~ "St. Johns",
        cty_fla_v2_6e16f0 == 59 ~ "St. Lucie",
        cty_fla_v2_6e16f0 == 60 ~ "Sumter",
        cty_fla_v2_6e16f0 == 61 ~ "Suwannee",
        cty_fla_v2_6e16f0 == 62 ~ "Taylor",
        cty_fla_v2_6e16f0 == 64 ~ "Volusia",
        cty_fla_v2_6e16f0 == 66 ~ "Walton",
        cty_fla_v2_6e16f0 == 67 ~ "Washington",
        TRUE ~ NA_character_),
      county_ga = case_when(
        cty_ga_v2_6b4912 == 2 ~ "Atkinson",
        cty_ga_v2_6b4912 == 3 ~ "Bacon",
        cty_ga_v2_6b4912 == 4 ~ "Baker",
        cty_ga_v2_6b4912 == 5 ~ "Baldwin",
        cty_ga_v2_6b4912 == 7 ~ "Barrow",
        cty_ga_v2_6b4912 == 8 ~ "Bartow",
        cty_ga_v2_6b4912 == 9 ~ "Ben Hill",
        cty_ga_v2_6b4912 == 11 ~ "Bibb",
        cty_ga_v2_6b4912 == 13 ~ "Brantley",
        cty_ga_v2_6b4912 == 15 ~ "Bryan",
        cty_ga_v2_6b4912 == 16 ~ "Bulloch",
        cty_ga_v2_6b4912 == 22 ~ "Carroll",
        cty_ga_v2_6b4912 == 25 ~ "Chatham",
        cty_ga_v2_6b4912 == 26 ~ "Chattahoochee",
        cty_ga_v2_6b4912 == 27 ~ "Chattooga",
        cty_ga_v2_6b4912 == 28 ~ "Cherokee",
        cty_ga_v2_6b4912 == 29 ~ "Clarke",
        cty_ga_v2_6b4912 == 31 ~ "Clayton",
        cty_ga_v2_6b4912 == 33 ~ "Cobb",
        cty_ga_v2_6b4912 == 38 ~ "Coweta",
        cty_ga_v2_6b4912 == 42 ~ "Dawson",
        cty_ga_v2_6b4912 == 43 ~ "Decatur",
        cty_ga_v2_6b4912 == 44 ~ "DeKalb",
        cty_ga_v2_6b4912 == 45 ~ "Dodge",
        cty_ga_v2_6b4912 == 47 ~ "Dougherty",
        cty_ga_v2_6b4912 == 48 ~ "Douglas",
        cty_ga_v2_6b4912 == 51 ~ "Effingham",
        cty_ga_v2_6b4912 == 56 ~ "Fayette",
        cty_ga_v2_6b4912 == 58 ~ "Forsyth",
        cty_ga_v2_6b4912 == 60 ~ "Fulton",
        cty_ga_v2_6b4912 == 62 ~ "Glascock",
        cty_ga_v2_6b4912 == 63 ~ "Glynn",
        cty_ga_v2_6b4912 == 67 ~ "Gwinnett",
        cty_ga_v2_6b4912 == 69 ~ "Hall",
        cty_ga_v2_6b4912 == 70 ~ "Hancock",
        cty_ga_v2_6b4912 == 71 ~ "Haralson",
        cty_ga_v2_6b4912 == 72 ~ "Harris",
        cty_ga_v2_6b4912 == 75 ~ "Henry",
        cty_ga_v2_6b4912 == 76 ~ "Houston",
        cty_ga_v2_6b4912 == 78 ~ "Jackson",
        cty_ga_v2_6b4912 == 81 ~ "Jefferson",
        cty_ga_v2_6b4912 == 84 ~ "Jones",
        cty_ga_v2_6b4912 == 89 ~ "Liberty",
        cty_ga_v2_6b4912 == 91 ~ "Long",
        cty_ga_v2_6b4912 == 92 ~ "Lowndes",
        cty_ga_v2_6b4912 == 95 ~ "Madison",
        cty_ga_v2_6b4912 == 105 ~ "Murray",
        cty_ga_v2_6b4912 == 106 ~ "Muscogee",
        cty_ga_v2_6b4912 == 110 ~ "Paulding",
        cty_ga_v2_6b4912 == 111 ~ "Peach",
        cty_ga_v2_6b4912 == 117 ~ "Putnam",
        cty_ga_v2_6b4912 == 121 ~ "Richmond",
        cty_ga_v2_6b4912 == 122 ~ "Rockdale",
        cty_ga_v2_6b4912 == 123 ~ "Schley",
        cty_ga_v2_6b4912 == 136 ~ "Thomas",
        cty_ga_v2_6b4912 == 137 ~ "Tift",
        cty_ga_v2_6b4912 == 146 ~ "Walker",
        cty_ga_v2_6b4912 == 147 ~ "Walton",
        cty_ga_v2_6b4912 == 150 ~ "Washington",
        cty_ga_v2_6b4912 == 154 ~ "White",
        cty_ga_v2_6b4912 == 155 ~ "Whitfield",
        TRUE ~ NA_character_),
      
      county_hi = case_when(
        cty_hi_v2_3fe9cc == 1 ~ "Hawaii",
        cty_hi_v2_3fe9cc == 2 ~ "Honolulu",
        cty_hi_v2_3fe9cc == 5 ~ "Maui",
        TRUE ~ NA_character_),
      county_id = case_when(
        cty_id_v2_13a608 == 1 ~ "Ada",
        cty_id_v2_13a608 == 3 ~ "Bannock",
        cty_id_v2_13a608 == 7 ~ "Blaine",
        cty_id_v2_13a608 == 10 ~ "Bonneville",
        cty_id_v2_13a608 == 14 ~ "Canyon",
        cty_id_v2_13a608 == 20 ~ "Elmore",
        cty_id_v2_13a608 == 26 ~ "Jefferson",
        cty_id_v2_13a608 == 28 ~ "Kootenai",
        cty_id_v2_13a608 == 33 ~ "Madison",
        cty_id_v2_13a608 == 35 ~ "Nez Perce",
        TRUE ~ NA_character_),
      county_ill = case_when(
        cty_ill_v2_09efc4 == 1 ~ "Adams",
        cty_ill_v2_09efc4 == 2 ~ "Alexander",
        cty_ill_v2_09efc4 == 4 ~ "Boone",
        cty_ill_v2_09efc4 == 10 ~ "Champaign",
        cty_ill_v2_09efc4 == 11 ~ "Christian",
        cty_ill_v2_09efc4 == 14 ~ "Clinton",
        cty_ill_v2_09efc4 == 16 ~ "Cook",
        cty_ill_v2_09efc4 == 17 ~ "Crawford",
        cty_ill_v2_09efc4 == 20 ~ "DeKalb",
        cty_ill_v2_09efc4 == 22 ~ "DuPage",
        cty_ill_v2_09efc4 == 28 ~ "Franklin",
        cty_ill_v2_09efc4 == 32 ~ "Grundy",
        cty_ill_v2_09efc4 == 34 ~ "Hancock",
        cty_ill_v2_09efc4 == 38 ~ "Iroquois",
        cty_ill_v2_09efc4 == 39 ~ "Jackson",
        cty_ill_v2_09efc4 == 40 ~ "Jasper",
        cty_ill_v2_09efc4 == 41 ~ "Jefferson",
        cty_ill_v2_09efc4 == 42 ~ "Jersey",
        cty_ill_v2_09efc4 == 44 ~ "Johnson",
        cty_ill_v2_09efc4 == 45 ~ "Kane",
        cty_ill_v2_09efc4 == 46 ~ "Kankakee",
        cty_ill_v2_09efc4 == 48 ~ "Knox",
        cty_ill_v2_09efc4 == 49 ~ "Lake",
        cty_ill_v2_09efc4 == 53 ~ "Livingston",
        cty_ill_v2_09efc4 == 57 ~ "Madison",
        cty_ill_v2_09efc4 == 63 ~ "McHenry",
        cty_ill_v2_09efc4 == 64 ~ "McLean",
        cty_ill_v2_09efc4 == 68 ~ "Montgomery",
        cty_ill_v2_09efc4 == 72 ~ "Peoria",
        cty_ill_v2_09efc4 == 81 ~ "Rock Island",
        cty_ill_v2_09efc4 == 83 ~ "Sangamon",
        cty_ill_v2_09efc4 == 86 ~ "Shelby",
        cty_ill_v2_09efc4 == 87 ~ "St. Clair",
        cty_ill_v2_09efc4 == 94 ~ "Warren",
        cty_ill_v2_09efc4 == 95 ~ "Washington",
        cty_ill_v2_09efc4 == 98 ~ "Whiteside",
        cty_ill_v2_09efc4 == 99 ~ "Will",
        cty_ill_v2_09efc4 == 100 ~ "Williamson",
        TRUE ~ NA_character_),
      county_ind = case_when(
        cty_ind_v2_932836 == 2 ~ "Allen",
        cty_ind_v2_932836 == 3 ~ "Bartholomew",
        cty_ind_v2_932836 == 6 ~ "Boone",
        cty_ind_v2_932836 == 7 ~ "Brown",
        cty_ind_v2_932836 == 10 ~ "Clark",
        cty_ind_v2_932836 == 18 ~ "Delaware",
        cty_ind_v2_932836 == 22 ~ "Floyd",
        cty_ind_v2_932836 == 27 ~ "Grant",
        cty_ind_v2_932836 == 28 ~ "Greene",
        cty_ind_v2_932836 == 29 ~ "Hamilton",
        cty_ind_v2_932836 == 30 ~ "Hancock",
        cty_ind_v2_932836 == 31 ~ "Harrison",
        cty_ind_v2_932836 == 32 ~ "Hendricks",
        cty_ind_v2_932836 == 33 ~ "Henry",
        cty_ind_v2_932836 == 35 ~ "Huntington",
        cty_ind_v2_932836 == 36 ~ "Jackson",
        cty_ind_v2_932836 == 45 ~ "Lake",
        cty_ind_v2_932836 == 46 ~ "LaPorte",
        cty_ind_v2_932836 == 48 ~ "Madison",
        cty_ind_v2_932836 == 49 ~ "Marion",
        cty_ind_v2_932836 == 53 ~ "Monroe",
        cty_ind_v2_932836 == 55 ~ "Morgan",
        cty_ind_v2_932836 == 57 ~ "Noble",
        cty_ind_v2_932836 == 64 ~ "Porter",
        cty_ind_v2_932836 == 74 ~ "St. Joseph",
        cty_ind_v2_932836 == 76 ~ "Steuben",
        cty_ind_v2_932836 == 80 ~ "Tipton",
        cty_ind_v2_932836 == 82 ~ "Vanderburgh",
        cty_ind_v2_932836 == 84 ~ "Vigo",
        cty_ind_v2_932836 == 87 ~ "Warrick",
        cty_ind_v2_932836 == 92 ~ "Whitley",
        TRUE ~ NA_character_),
      county_iowa = case_when(
        cty_iowa_v2_51d17f == 98 ~ "Black Hawk",
        cty_iowa_v2_51d17f == 99 ~ "Boone",
        cty_iowa_v2_51d17f == 100 ~ "Bremer",
        cty_iowa_v2_51d17f == 103 ~ "Butler",
        cty_iowa_v2_51d17f == 107 ~ "Cedar",
        cty_iowa_v2_51d17f == 119 ~ "Delaware",
        cty_iowa_v2_51d17f == 120 ~ "Des Moines",
        cty_iowa_v2_51d17f == 143 ~ "Johnson",
        cty_iowa_v2_51d17f == 148 ~ "Linn",
        cty_iowa_v2_51d17f == 149 ~ "Louisa",
        cty_iowa_v2_51d17f == 168 ~ "Polk",
        cty_iowa_v2_51d17f == 170 ~ "Poweshiek",
        cty_iowa_v2_51d17f == 173 ~ "Scott",
        cty_iowa_v2_51d17f == 176 ~ "Story",
        cty_iowa_v2_51d17f == 188 ~ "Woodbury",
        TRUE ~ NA_character_),
      county_ks = case_when(
        cty_ks_v2_586289 == 192 ~ "Atchison",
        cty_ks_v2_586289 == 195 ~ "Bourbon",
        cty_ks_v2_586289 == 212 ~ "Douglas",
        cty_ks_v2_586289 == 220 ~ "Geary",
        cty_ks_v2_586289 == 235 ~ "Johnson",
        cty_ks_v2_586289 == 243 ~ "Linn",
        cty_ks_v2_586289 == 248 ~ "McPherson",
        cty_ks_v2_586289 == 252 ~ "Montgomery",
        cty_ks_v2_586289 == 261 ~ "Ottawa",
        cty_ks_v2_586289 == 276 ~ "Sedgwick",
        cty_ks_v2_586289 == 278 ~ "Shawnee",
        cty_ks_v2_586289 == 282 ~ "Stafford",
        cty_ks_v2_586289 == 289 ~ "Wallace",
        TRUE ~ NA_character_),
      county_ky = case_when(
        cty_ky_v2_dd7186 == 290 ~ "Allen",
        cty_ky_v2_dd7186 == 295 ~ "Bell",
        cty_ky_v2_dd7186 == 296 ~ "Boone",
        cty_ky_v2_dd7186 == 297 ~ "Bourbon",
        cty_ky_v2_dd7186 == 312 ~ "Christian",
        cty_ky_v2_dd7186 == 313 ~ "Clark",
        cty_ky_v2_dd7186 == 318 ~ "Daviess",
        cty_ky_v2_dd7186 == 322 ~ "Fayette",
        cty_ky_v2_dd7186 == 329 ~ "Grant",
        cty_ky_v2_dd7186 == 335 ~ "Hardin",
        cty_ky_v2_dd7186 == 344 ~ "Jefferson",
        cty_ky_v2_dd7186 == 347 ~ "Kenton",
        cty_ky_v2_dd7186 == 348 ~ "Knott",
        cty_ky_v2_dd7186 == 350 ~ "Larue",
        cty_ky_v2_dd7186 == 351 ~ "Laurel",
        cty_ky_v2_dd7186 == 352 ~ "Lawrence",
        cty_ky_v2_dd7186 == 357 ~ "Lincoln",
        cty_ky_v2_dd7186 == 361 ~ "Madison",
        cty_ky_v2_dd7186 == 376 ~ "Morgan",
        cty_ky_v2_dd7186 == 378 ~ "Nelson",
        cty_ky_v2_dd7186 == 381 ~ "Oldham",
        cty_ky_v2_dd7186 == 386 ~ "Pike",
        cty_ky_v2_dd7186 == 392 ~ "Russell",
        cty_ky_v2_dd7186 == 393 ~ "Scott",
        cty_ky_v2_dd7186 == 395 ~ "Simpson",
        cty_ky_v2_dd7186 == 398 ~ "Todd",
        cty_ky_v2_dd7186 == 402 ~ "Warren",
        TRUE ~ NA_character_),
      county_la = case_when(
        cty_lou_v2_11a316 == 411 ~ "Assumption",
        cty_lou_v2_11a316 == 413 ~ "Beauregard",
        cty_lou_v2_11a316 == 414 ~ "Bienville",
        cty_lou_v2_11a316 == 415 ~ "Bossier",
        cty_lou_v2_11a316 == 416 ~ "Caddo",
        cty_lou_v2_11a316 == 420 ~ "Catahoula",
        cty_lou_v2_11a316 == 424 ~ "East Baton Rouge",
        cty_lou_v2_11a316 == 427 ~ "Evangeline",
        cty_lou_v2_11a316 == 429 ~ "Grant",
        cty_lou_v2_11a316 == 430 ~ "Iberia",
        cty_lou_v2_11a316 == 431 ~ "Iberville",
        cty_lou_v2_11a316 == 433 ~ "Jefferson",
        cty_lou_v2_11a316 == 435 ~ "Lafayette",
        cty_lou_v2_11a316 == 438 ~ "Lincoln",
        cty_lou_v2_11a316 == 439 ~ "Livingston",
        cty_lou_v2_11a316 == 443 ~ "Orleans",
        cty_lou_v2_11a316 == 444 ~ "Ouachita",
        cty_lou_v2_11a316 == 445 ~ "Plaquemines",
        cty_lou_v2_11a316 == 452 ~ "St. Charles",
        cty_lou_v2_11a316 == 454 ~ "St. James",
        cty_lou_v2_11a316 == 456 ~ "St. Landry",
        cty_lou_v2_11a316 == 457 ~ "St. Martin",
        cty_lou_v2_11a316 == 459 ~ "St. Tammany",
        cty_lou_v2_11a316 == 460 ~ "Tangipahoa",
        cty_lou_v2_11a316 == 462 ~ "Terrebonne",
        cty_lou_v2_11a316 == 466 ~ "Washington",
        TRUE ~ NA_character_),
      county_me = case_when(
        cty_me_v2_76342c == 1 ~ "Androscoggin",
        cty_me_v2_76342c == 473 ~ "Cumberland",
        cty_me_v2_76342c == 475 ~ "Hancock",
        cty_me_v2_76342c == 476 ~ "Kennebec",
        cty_me_v2_76342c == 477 ~ "Knox",
        cty_me_v2_76342c == 486 ~ "York",
        TRUE ~ NA_character_),
      county_md = case_when(
        cty_md_v2_86408a == 1 ~ "Allegany",
        cty_md_v2_86408a == 487 ~ "Anne Arundel",
        cty_md_v2_86408a == 488 ~ "Baltimore",
        cty_md_v2_86408a == 489 ~ "Baltimore city",
        cty_md_v2_86408a == 492 ~ "Carroll",
        cty_md_v2_86408a == 493 ~ "Cecil",
        cty_md_v2_86408a == 494 ~ "Charles",
        cty_md_v2_86408a == 496 ~ "Frederick",
        cty_md_v2_86408a == 498 ~ "Harford",
        cty_md_v2_86408a == 499 ~ "Howard",
        cty_md_v2_86408a == 501 ~ "Montgomery",
        cty_md_v2_86408a == 502 ~ "Prince George's",
        cty_md_v2_86408a == 503 ~ "Queen Anne's",
        cty_md_v2_86408a == 505 ~ "St. Mary's",
        cty_md_v2_86408a == 506 ~ "Talbot",
        TRUE ~ NA_character_),
      county_ma = case_when(
        cty_ma_v2_2b0f6e == 1 ~ "Barnstable",
        cty_ma_v2_2b0f6e == 510 ~ "Berkshire",
        cty_ma_v2_2b0f6e == 511 ~ "Bristol",
        cty_ma_v2_2b0f6e == 512 ~ "Dukes",
        cty_ma_v2_2b0f6e == 513 ~ "Essex",
        cty_ma_v2_2b0f6e == 514 ~ "Franklin",
        cty_ma_v2_2b0f6e == 515 ~ "Hampden",
        cty_ma_v2_2b0f6e == 516 ~ "Hampshire",
        cty_ma_v2_2b0f6e == 517 ~ "Middlesex",
        cty_ma_v2_2b0f6e == 519 ~ "Norfolk",
        cty_ma_v2_2b0f6e == 520 ~ "Plymouth",
        cty_ma_v2_2b0f6e == 521 ~ "Suffolk",
        cty_ma_v2_2b0f6e == 522 ~ "Worcester",
        TRUE ~ NA_character_),
      county_mi = case_when(
        cty_mi_v2_c533af == 1 ~ "Alcona",
        cty_mi_v2_c533af == 524 ~ "Allegan",
        cty_mi_v2_c533af == 525 ~ "Alpena",
        cty_mi_v2_c533af == 530 ~ "Bay",
        cty_mi_v2_c533af == 532 ~ "Berrien",
        cty_mi_v2_c533af == 534 ~ "Calhoun",
        cty_mi_v2_c533af == 536 ~ "Charlevoix",
        cty_mi_v2_c533af == 539 ~ "Clare",
        cty_mi_v2_c533af == 540 ~ "Clinton",
        cty_mi_v2_c533af == 542 ~ "Delta",
        cty_mi_v2_c533af == 543 ~ "Dickinson",
        cty_mi_v2_c533af == 545 ~ "Emmet",
        cty_mi_v2_c533af == 546 ~ "Genesee",
        cty_mi_v2_c533af == 549 ~ "Grand Traverse",
        cty_mi_v2_c533af == 550 ~ "Gratiot",
        cty_mi_v2_c533af == 553 ~ "Huron",
        cty_mi_v2_c533af == 554 ~ "Ingham",
        cty_mi_v2_c533af == 558 ~ "Isabella",
        cty_mi_v2_c533af == 559 ~ "Jackson",
        cty_mi_v2_c533af == 560 ~ "Kalamazoo",
        cty_mi_v2_c533af == 562 ~ "Kent",
        cty_mi_v2_c533af == 567 ~ "Lenawee",
        cty_mi_v2_c533af == 568 ~ "Livingston",
        cty_mi_v2_c533af == 571 ~ "Macomb",
        cty_mi_v2_c533af == 575 ~ "Mecosta",
        cty_mi_v2_c533af == 577 ~ "Midland",
        cty_mi_v2_c533af == 579 ~ "Monroe",
        cty_mi_v2_c533af == 580 ~ "Montcalm",
        cty_mi_v2_c533af == 584 ~ "Oakland",
        cty_mi_v2_c533af == 586 ~ "Ogemaw",
        cty_mi_v2_c533af == 591 ~ "Ottawa",
        cty_mi_v2_c533af == 598 ~ "St. Clair",
        cty_mi_v2_c533af == 600 ~ "Tuscola",
        cty_mi_v2_c533af == 601 ~ "Van Buren",
        cty_mi_v2_c533af == 602 ~ "Washtenaw",
        cty_mi_v2_c533af == 603 ~ "Wayne",
        cty_mi_v2_c533af == 604 ~ "Wexford",
        TRUE ~ NA_character_),
      county_mn = case_when(
        cty_mn_v2_a6b8c9 == 605 ~ "Anoka",
        cty_mn_v2_a6b8c9 == 606 ~ "Becker",
        cty_mn_v2_a6b8c9 == 608 ~ "Benton",
        cty_mn_v2_a6b8c9 == 610 ~ "Blue Earth",
        cty_mn_v2_a6b8c9 == 613 ~ "Carver",
        cty_mn_v2_a6b8c9 == 616 ~ "Chisago",
        cty_mn_v2_a6b8c9 == 617 ~ "Clay",
        cty_mn_v2_a6b8c9 == 622 ~ "Dakota",
        cty_mn_v2_a6b8c9 == 630 ~ "Hennepin",
        cty_mn_v2_a6b8c9 == 637 ~ "Kandiyohi",
        cty_mn_v2_a6b8c9 == 641 ~ "Lake",
        cty_mn_v2_a6b8c9 == 651 ~ "Lake of the Woods",
        cty_mn_v2_a6b8c9 == 659 ~ "Mille Lacs",
        cty_mn_v2_a6b8c9 == 661 ~ "Otter Tail",
        cty_mn_v2_a6b8c9 == 665 ~ "Pine",
        cty_mn_v2_a6b8c9 == 673 ~ "Ramsey",
        cty_mn_v2_a6b8c9 == 675 ~ "Sherburne",
        cty_mn_v2_a6b8c9 == 676 ~ "St. Louis",
        cty_mn_v2_a6b8c9 == 685 ~ "Stearns",
        cty_mn_v2_a6b8c9 == 688 ~ "Washington",
        cty_mn_v2_a6b8c9 == 689 ~ "Winona",
        TRUE ~ NA_character_),
      county_ms = case_when(
        cty_ms_v2_2eb3ea == 1 ~ "Adams",
        cty_ms_v2_2eb3ea == 691 ~ "Alcorn",
        cty_ms_v2_2eb3ea == 693 ~ "Attala",
        cty_ms_v2_2eb3ea == 701 ~ "Clarke",
        cty_ms_v2_2eb3ea == 702 ~ "Clay",
        cty_ms_v2_2eb3ea == 706 ~ "DeSoto",
        cty_ms_v2_2eb3ea == 707 ~ "Forrest",
        cty_ms_v2_2eb3ea == 708 ~ "Franklin",
        cty_ms_v2_2eb3ea == 709 ~ "George",
        cty_ms_v2_2eb3ea == 711 ~ "Grenada",
        cty_ms_v2_2eb3ea == 713 ~ "Harrison",
        cty_ms_v2_2eb3ea == 714 ~ "Hinds",
        cty_ms_v2_2eb3ea == 719 ~ "Jackson",
        cty_ms_v2_2eb3ea == 723 ~ "Jones",
        cty_ms_v2_2eb3ea == 726 ~ "Lamar",
        cty_ms_v2_2eb3ea == 727 ~ "Lauderdale",
        cty_ms_v2_2eb3ea == 732 ~ "Lincoln",
        cty_ms_v2_2eb3ea == 734 ~ "Madison",
        cty_ms_v2_2eb3ea == 735 ~ "Marion",
        cty_ms_v2_2eb3ea == 736 ~ "Marshall",
        cty_ms_v2_2eb3ea == 744 ~ "Pearl River",
        cty_ms_v2_2eb3ea == 746 ~ "Pike",
        cty_ms_v2_2eb3ea == 750 ~ "Rankin",
        cty_ms_v2_2eb3ea == 765 ~ "Washington",
        TRUE ~ NA_character_),
      county_mo = case_when(
        cty_mo_v2_f7cf0f == 776 ~ "Barton",
        cty_mo_v2_f7cf0f == 778 ~ "Benton",
        cty_mo_v2_f7cf0f == 780 ~ "Boone",
        cty_mo_v2_f7cf0f == 789 ~ "Cass",
        cty_mo_v2_f7cf0f == 794 ~ "Clay",
        cty_mo_v2_f7cf0f == 796 ~ "Cole",
        cty_mo_v2_f7cf0f == 806 ~ "Franklin",
        cty_mo_v2_f7cf0f == 809 ~ "Greene",
        cty_mo_v2_f7cf0f == 818 ~ "Jackson",
        cty_mo_v2_f7cf0f == 819 ~ "Jasper",
        cty_mo_v2_f7cf0f == 820 ~ "Jefferson",
        cty_mo_v2_f7cf0f == 824 ~ "Lafayette",
        cty_mo_v2_f7cf0f == 825 ~ "Lawrence",
        cty_mo_v2_f7cf0f == 827 ~ "Lincoln",
        cty_mo_v2_f7cf0f == 836 ~ "Miller",
        cty_mo_v2_f7cf0f == 847 ~ "Ozark",
        cty_mo_v2_f7cf0f == 849 ~ "Perry",
        cty_mo_v2_f7cf0f == 850 ~ "Pettis",
        cty_mo_v2_f7cf0f == 851 ~ "Phelps",
        cty_mo_v2_f7cf0f == 853 ~ "Platte",
        cty_mo_v2_f7cf0f == 855 ~ "Pulaski",
        cty_mo_v2_f7cf0f == 865 ~ "Scott",
        cty_mo_v2_f7cf0f == 868 ~ "St. Charles",
        cty_mo_v2_f7cf0f == 870 ~ "St. Francois",
        cty_mo_v2_f7cf0f == 871 ~ "St. Louis",
        cty_mo_v2_f7cf0f == 872 ~ "St. Louis city",
        cty_mo_v2_f7cf0f == 881 ~ "Washington",
        cty_mo_v2_f7cf0f == 883 ~ "Webster",
        TRUE ~ NA_character_),
      county_mt = case_when(
        cty_mt_v2_eece85 == 900 ~ "Gallatin",
        cty_mt_v2_eece85 == 909 ~ "Lewis and Clark",
        TRUE ~ NA_character_),
      county_nb = case_when(
        cty_nb_v2_1845de == 949 ~ "Buffalo",
        cty_nb_v2_1845de == 952 ~ "Cass",
        cty_nb_v2_1845de == 967 ~ "Douglas",
        cty_nb_v2_1845de == 968 ~ "Dundy",
        cty_nb_v2_1845de == 973 ~ "Gage",
        cty_nb_v2_1845de == 980 ~ "Hamilton",
        cty_nb_v2_1845de == 994 ~ "Lancaster",
        cty_nb_v2_1845de == 995 ~ "Lincoln",
        cty_nb_v2_1845de == 1005 ~ "Otoe",
        cty_nb_v2_1845de == 1016 ~ "Sarpy",
        cty_nb_v2_1845de == 1025 ~ "Thomas",
        TRUE ~ NA_character_),
      county_nj = case_when(
        cty_nj_v2_d518e1 == 1 ~ "Atlantic",
        cty_nj_v2_d518e1 == 1058 ~ "Bergen",
        cty_nj_v2_d518e1 == 1059 ~ "Burlington",
        cty_nj_v2_d518e1 == 1061 ~ "Cape May",
        cty_nj_v2_d518e1 == 1063 ~ "Essex",
        cty_nj_v2_d518e1 == 1064 ~ "Gloucester",
        cty_nj_v2_d518e1 == 1065 ~ "Hudson",
        cty_nj_v2_d518e1 == 1066 ~ "Hunterdon",
        cty_nj_v2_d518e1 == 1067 ~ "Mercer",
        cty_nj_v2_d518e1 == 1068 ~ "Middlesex",
        cty_nj_v2_d518e1 == 1069 ~ "Monmouth",
        cty_nj_v2_d518e1 == 1070 ~ "Morris",
        cty_nj_v2_d518e1 == 1071 ~ "Ocean",
        cty_nj_v2_d518e1 == 1072 ~ "Passaic",
        cty_nj_v2_d518e1 == 1073 ~ "Salem",
        cty_nj_v2_d518e1 == 1074 ~ "Somerset",
        cty_nj_v2_d518e1 == 1075 ~ "Sussex",
        cty_nj_v2_d518e1 == 1076 ~ "Union",
        cty_nj_v2_d518e1 == 1077 ~ "Warren",
        TRUE ~ NA_character_),
      county_nm = case_when(
        cty_nm_v2_2da9b4 == 1 ~ "Bernalillo",
        cty_nm_v2_2da9b4 == 1078 ~ "Catron",
        cty_nm_v2_2da9b4 == 1079 ~ "Chaves",
        cty_nm_v2_2da9b4 == 1084 ~ "Dona Ana",
        cty_nm_v2_2da9b4 == 1086 ~ "Grant",
        cty_nm_v2_2da9b4 == 1087 ~ "Guadalupe",
        cty_nm_v2_2da9b4 == 1090 ~ "Lea",
        cty_nm_v2_2da9b4 == 1091 ~ "Lincoln",
        cty_nm_v2_2da9b4 == 1099 ~ "Roosevelt",
        cty_nm_v2_2da9b4 == 1103 ~ "Santa Fe",
        cty_nm_v2_2da9b4 == 1109 ~ "Valencia",
        TRUE ~ NA_character_),
      county_ny = case_when(
        cty_ny_v2_72a698 == 1 ~ "Albany",
        cty_ny_v2_72a698 == 1110 ~ "Bronx",
        cty_ny_v2_72a698 == 1111 ~ "Broome",
        cty_ny_v2_72a698 == 1112 ~ "Chautauqua",
        cty_ny_v2_72a698 == 1113 ~ "Chemung",
        cty_ny_v2_72a698 == 1114 ~ "Chenango",
        cty_ny_v2_72a698 == 1115 ~ "Clinton",
        cty_ny_v2_72a698 == 1116 ~ "Delaware",
        cty_ny_v2_72a698 == 1118 ~ "Dutchess",
        cty_ny_v2_72a698 == 1119 ~ "Erie",
        cty_ny_v2_72a698 == 1120 ~ "Genesee",
        cty_ny_v2_72a698 == 1121 ~ "Kings",
        cty_ny_v2_72a698 == 1122 ~ "Livingston",
        cty_ny_v2_72a698 == 1125 ~ "Madison",
        cty_ny_v2_72a698 == 1126 ~ "Monroe",
        cty_ny_v2_72a698 == 1127 ~ "Nassau",
        cty_ny_v2_72a698 == 1128 ~ "New York",
        cty_ny_v2_72a698 == 1129 ~ "Niagara",
        cty_ny_v2_72a698 == 1130 ~ "Oneida",
        cty_ny_v2_72a698 == 1131 ~ "Onondaga",
        cty_ny_v2_72a698 == 1132 ~ "Ontario",
        cty_ny_v2_72a698 == 1133 ~ "Orange",
        cty_ny_v2_72a698 == 1134 ~ "Orleans",
        cty_ny_v2_72a698 == 1135 ~ "Oswego",
        cty_ny_v2_72a698 == 1136 ~ "Otsego",
        cty_ny_v2_72a698 == 1137 ~ "Putnam",
        cty_ny_v2_72a698 == 1138 ~ "Queens",
        cty_ny_v2_72a698 == 1139 ~ "Rensselaer",
        cty_ny_v2_72a698 == 1140 ~ "Richmond",
        cty_ny_v2_72a698 == 1141 ~ "Rockland",
        cty_ny_v2_72a698 == 1143 ~ "Saratoga",
        cty_ny_v2_72a698 == 1144 ~ "Schenectady",
        cty_ny_v2_72a698 == 1145 ~ "Seneca",
        cty_ny_v2_72a698 == 1147 ~ "St. Lawrence",
        cty_ny_v2_72a698 == 1152 ~ "Steuben",
        cty_ny_v2_72a698 == 1156 ~ "Suffolk",
        cty_ny_v2_72a698 == 1157 ~ "Sullivan",
        cty_ny_v2_72a698 == 1158 ~ "Tompkins",
        cty_ny_v2_72a698 == 1161 ~ "Ulster",
        cty_ny_v2_72a698 == 1162 ~ "Warren",
        cty_ny_v2_72a698 == 1163 ~ "Washington",
        cty_ny_v2_72a698 == 1164 ~ "Wayne",
        cty_ny_v2_72a698 == 1167 ~ "Westchester",
        cty_ny_v2_72a698 == 1168 ~ "Wyoming",
        cty_ny_v2_72a698 == 1170 ~ "Yates",
        TRUE ~ NA_character_),
      county_nc = case_when(
        cty_nc_v2_60c0bd == 1 ~ "Alamance",
        cty_nc_v2_60c0bd == 1172 ~ "Alleghany",
        cty_nc_v2_60c0bd == 1176 ~ "Beaufort",
        cty_nc_v2_60c0bd == 1178 ~ "Bladen",
        cty_nc_v2_60c0bd == 1179 ~ "Brunswick",
        cty_nc_v2_60c0bd == 1180 ~ "Buncombe",
        cty_nc_v2_60c0bd == 1181 ~ "Burke",
        cty_nc_v2_60c0bd == 1182 ~ "Cabarrus",
        cty_nc_v2_60c0bd == 1183 ~ "Caldwell",
        cty_nc_v2_60c0bd == 1187 ~ "Catawba",
        cty_nc_v2_60c0bd == 1189 ~ "Cherokee",
        cty_nc_v2_60c0bd == 1192 ~ "Cleveland",
        cty_nc_v2_60c0bd == 1194 ~ "Craven",
        cty_nc_v2_60c0bd == 1195 ~ "Cumberland",
        cty_nc_v2_60c0bd == 1196 ~ "Currituck",
        cty_nc_v2_60c0bd == 1199 ~ "Davie",
        cty_nc_v2_60c0bd == 1201 ~ "Durham",
        cty_nc_v2_60c0bd == 1203 ~ "Forsyth",
        cty_nc_v2_60c0bd == 1204 ~ "Franklin",
        cty_nc_v2_60c0bd == 1205 ~ "Gaston",
        cty_nc_v2_60c0bd == 1206 ~ "Gates",
        cty_nc_v2_60c0bd == 1208 ~ "Granville",
        cty_nc_v2_60c0bd == 1210 ~ "Guilford",
        cty_nc_v2_60c0bd == 1212 ~ "Harnett",
        cty_nc_v2_60c0bd == 1214 ~ "Henderson",
        cty_nc_v2_60c0bd == 1218 ~ "Iredell",
        cty_nc_v2_60c0bd == 1220 ~ "Johnston",
        cty_nc_v2_60c0bd == 1223 ~ "Lenoir",
        cty_nc_v2_60c0bd == 1225 ~ "Macon",
        cty_nc_v2_60c0bd == 1229 ~ "Mecklenburg",
        cty_nc_v2_60c0bd == 1232 ~ "Moore",
        cty_nc_v2_60c0bd == 1233 ~ "Nash",
        cty_nc_v2_60c0bd == 1234 ~ "New Hanover",
        cty_nc_v2_60c0bd == 1235 ~ "Northampton",
        cty_nc_v2_60c0bd == 1236 ~ "Onslow",
        cty_nc_v2_60c0bd == 1237 ~ "Orange",
        cty_nc_v2_60c0bd == 1238 ~ "Pamlico",
        cty_nc_v2_60c0bd == 1239 ~ "Pasquotank",
        cty_nc_v2_60c0bd == 1243 ~ "Pitt",
        cty_nc_v2_60c0bd == 1245 ~ "Randolph",
        cty_nc_v2_60c0bd == 1249 ~ "Rowan",
        cty_nc_v2_60c0bd == 1251 ~ "Sampson",
        cty_nc_v2_60c0bd == 1253 ~ "Stanly",
        cty_nc_v2_60c0bd == 1255 ~ "Surry",
        cty_nc_v2_60c0bd == 1259 ~ "Union",
        cty_nc_v2_60c0bd == 1260 ~ "Vance",
        cty_nc_v2_60c0bd == 1261 ~ "Wake",
        cty_nc_v2_60c0bd == 1264 ~ "Watauga",
        TRUE ~ NA_character_),
      county_nd = case_when(
        cty_nd_v2_4e52e2 == 1270 ~ "Barnes",
        cty_nd_v2_4e52e2 == 1276 ~ "Burleigh",
        cty_nd_v2_4e52e2 == 1285 ~ "Golden Valley",
        cty_nd_v2_4e52e2 == 1286 ~ "Grand Forks",
        TRUE ~ NA_character_),
      county_nh = case_when(
        cty_nh_v2_7f5683 == 1049 ~ "Carroll",
        cty_nh_v2_7f5683 == 1050 ~ "Cheshire",
        cty_nh_v2_7f5683 == 1053 ~ "Hillsborough",
        cty_nh_v2_7f5683 == 1054 ~ "Merrimack",
        cty_nh_v2_7f5683 == 1055 ~ "Rockingham",
        cty_nh_v2_7f5683 == 1056 ~ "Strafford",
        cty_nh_v2_7f5683 == 1057 ~ "Sullivan",
        TRUE ~ NA_character_),
      county_nv = case_when(
        cty_nv_v2_cbfd57 == 1 ~ "Carson City",
        cty_nv_v2_cbfd57 == 1034 ~ "Clark",
        cty_nv_v2_cbfd57 == 1038 ~ "Eureka",
        cty_nv_v2_cbfd57 == 1042 ~ "Lyon",
        cty_nv_v2_cbfd57 == 1047 ~ "Washoe",
        TRUE ~ NA_character_),
      county_ut = case_when(
        cty_ut_v2_519d25 == 2047 ~ "Box Elder",
        cty_ut_v2_519d25 == 2048 ~ "Cache",
        cty_ut_v2_519d25 == 2051 ~ "Davis",
        cty_ut_v2_519d25 == 2063 ~ "Salt Lake",
        cty_ut_v2_519d25 == 2068 ~ "Tooele",
        cty_ut_v2_519d25 == 2070 ~ "Utah",
        cty_ut_v2_519d25 == 2074 ~ "Weber",
        TRUE ~ NA_character_),
      county_tx = case_when(
        cty_tx_v2_ef1618 == 1 ~ "Anderson",
        cty_tx_v2_ef1618 == 1795 ~ "Angelina",
        cty_tx_v2_ef1618 == 1798 ~ "Armstrong",
        cty_tx_v2_ef1618 == 1800 ~ "Austin",
        cty_tx_v2_ef1618 == 1802 ~ "Bandera",
        cty_tx_v2_ef1618 == 1804 ~ "Baylor",
        cty_tx_v2_ef1618 == 1806 ~ "Bell",
        cty_tx_v2_ef1618 == 1807 ~ "Bexar",
        cty_tx_v2_ef1618 == 1811 ~ "Bowie",
        cty_tx_v2_ef1618 == 1812 ~ "Brazoria",
        cty_tx_v2_ef1618 == 1813 ~ "Brazos",
        cty_tx_v2_ef1618 == 1820 ~ "Caldwell",
        cty_tx_v2_ef1618 == 1821 ~ "Calhoun",
        cty_tx_v2_ef1618 == 1823 ~ "Cameron",
        cty_tx_v2_ef1618 == 1828 ~ "Chambers",
        cty_tx_v2_ef1618 == 1829 ~ "Cherokee",
        cty_tx_v2_ef1618 == 1835 ~ "Collin",
        cty_tx_v2_ef1618 == 1837 ~ "Colorado",
        cty_tx_v2_ef1618 == 1838 ~ "Comal",
        cty_tx_v2_ef1618 == 1840 ~ "Concho",
        cty_tx_v2_ef1618 == 1842 ~ "Coryell",
        cty_tx_v2_ef1618 == 1845 ~ "Crockett",
        cty_tx_v2_ef1618 == 1849 ~ "Dallas",
        cty_tx_v2_ef1618 == 1853 ~ "Denton",
        cty_tx_v2_ef1618 == 1854 ~ "DeWitt",
        cty_tx_v2_ef1618 == 1860 ~ "Ector",
        cty_tx_v2_ef1618 == 1862 ~ "El Paso",
        cty_tx_v2_ef1618 == 1863 ~ "Ellis",
        cty_tx_v2_ef1618 == 1867 ~ "Fayette",
        cty_tx_v2_ef1618 == 1868 ~ "Fisher",
        cty_tx_v2_ef1618 == 1871 ~ "Fort Bend",
        cty_tx_v2_ef1618 == 1876 ~ "Galveston",
        cty_tx_v2_ef1618 == 1882 ~ "Gray",
        cty_tx_v2_ef1618 == 1883 ~ "Grayson",
        cty_tx_v2_ef1618 == 1884 ~ "Gregg",
        cty_tx_v2_ef1618 == 1886 ~ "Guadalupe",
        cty_tx_v2_ef1618 == 1893 ~ "Harris",
        cty_tx_v2_ef1618 == 1894 ~ "Harrison",
        cty_tx_v2_ef1618 == 1897 ~ "Hays",
        cty_tx_v2_ef1618 == 1899 ~ "Henderson",
        cty_tx_v2_ef1618 == 1900 ~ "Hidalgo",
        cty_tx_v2_ef1618 == 1902 ~ "Hockley",
        cty_tx_v2_ef1618 == 1905 ~ "Houston",
        cty_tx_v2_ef1618 == 1908 ~ "Hunt",
        cty_tx_v2_ef1618 == 1909 ~ "Hutchinson",
        cty_tx_v2_ef1618 == 1913 ~ "Jasper",
        cty_tx_v2_ef1618 == 1915 ~ "Jefferson",
        cty_tx_v2_ef1618 == 1918 ~ "Johnson",
        cty_tx_v2_ef1618 == 1921 ~ "Kaufman",
        cty_tx_v2_ef1618 == 1922 ~ "Kendall",
        cty_tx_v2_ef1618 == 1923 ~ "Kenedy",
        cty_tx_v2_ef1618 == 1931 ~ "La Salle",
        cty_tx_v2_ef1618 == 1932 ~ "Lamar",
        cty_tx_v2_ef1618 == 1938 ~ "Liberty",
        cty_tx_v2_ef1618 == 1944 ~ "Lubbock",
        cty_tx_v2_ef1618 == 1948 ~ "Martin",
        cty_tx_v2_ef1618 == 1951 ~ "Maverick",
        cty_tx_v2_ef1618 == 1953 ~ "McLennan",
        cty_tx_v2_ef1618 == 1962 ~ "Montgomery",
        cty_tx_v2_ef1618 == 1966 ~ "Nacogdoches",
        cty_tx_v2_ef1618 == 1970 ~ "Nueces",
        cty_tx_v2_ef1618 == 1973 ~ "Orange",
        cty_tx_v2_ef1618 == 1974 ~ "Palo Pinto",
        cty_tx_v2_ef1618 == 1976 ~ "Parker",
        cty_tx_v2_ef1618 == 1980 ~ "Potter",
        cty_tx_v2_ef1618 == 1983 ~ "Randall",
        cty_tx_v2_ef1618 == 1991 ~ "Rockwall",
        cty_tx_v2_ef1618 == 1997 ~ "San Patricio",
        cty_tx_v2_ef1618 == 2006 ~ "Starr",
        cty_tx_v2_ef1618 == 2012 ~ "Tarrant",
        cty_tx_v2_ef1618 == 2013 ~ "Taylor",
        cty_tx_v2_ef1618 == 2015 ~ "Terry",
        cty_tx_v2_ef1618 == 2018 ~ "Tom Green",
        cty_tx_v2_ef1618 == 2019 ~ "Travis",
        cty_tx_v2_ef1618 == 2024 ~ "Uvalde",
        cty_tx_v2_ef1618 == 2026 ~ "Van Zandt",
        cty_tx_v2_ef1618 == 2027 ~ "Victoria",
        cty_tx_v2_ef1618 == 2031 ~ "Washington",
        cty_tx_v2_ef1618 == 2032 ~ "Webb",
        cty_tx_v2_ef1618 == 2035 ~ "Wichita",
        cty_tx_v2_ef1618 == 2038 ~ "Williamson",
        TRUE ~ NA_character_),
      county_tn = case_when(
        cty_tn_v2_de9d03 == 1 ~ "Anderson",
        cty_tn_v2_de9d03 == 1700 ~ "Bedford",
        cty_tn_v2_de9d03 == 1703 ~ "Blount",
        cty_tn_v2_de9d03 == 1704 ~ "Bradley",
        cty_tn_v2_de9d03 == 1714 ~ "Coffee",
        cty_tn_v2_de9d03 == 1717 ~ "Davidson",
        cty_tn_v2_de9d03 == 1718 ~ "Decatur",
        cty_tn_v2_de9d03 == 1719 ~ "DeKalb",
        cty_tn_v2_de9d03 == 1728 ~ "Greene",
        cty_tn_v2_de9d03 == 1730 ~ "Hamblen",
        cty_tn_v2_de9d03 == 1731 ~ "Hamilton",
        cty_tn_v2_de9d03 == 1734 ~ "Hardin",
        cty_tn_v2_de9d03 == 1738 ~ "Henry",
        cty_tn_v2_de9d03 == 1739 ~ "Hickman",
        cty_tn_v2_de9d03 == 1740 ~ "Houston",
        cty_tn_v2_de9d03 == 1742 ~ "Jackson",
        cty_tn_v2_de9d03 == 1745 ~ "Knox",
        cty_tn_v2_de9d03 == 1749 ~ "Lewis",
        cty_tn_v2_de9d03 == 1750 ~ "Lincoln",
        cty_tn_v2_de9d03 == 1752 ~ "Macon",
        cty_tn_v2_de9d03 == 1753 ~ "Madison",
        cty_tn_v2_de9d03 == 1755 ~ "Marshall",
        cty_tn_v2_de9d03 == 1760 ~ "Monroe",
        cty_tn_v2_de9d03 == 1761 ~ "Montgomery",
        cty_tn_v2_de9d03 == 1764 ~ "Obion",
        cty_tn_v2_de9d03 == 1765 ~ "Overton",
        cty_tn_v2_de9d03 == 1773 ~ "Rutherford",
        cty_tn_v2_de9d03 == 1776 ~ "Sevier",
        cty_tn_v2_de9d03 == 1777 ~ "Shelby",
        cty_tn_v2_de9d03 == 1780 ~ "Sullivan",
        cty_tn_v2_de9d03 == 1781 ~ "Sumner",
        cty_tn_v2_de9d03 == 1788 ~ "Washington",
        cty_tn_v2_de9d03 == 1789 ~ "Wayne",
        cty_tn_v2_de9d03 == 1792 ~ "Williamson",
        cty_tn_v2_de9d03 == 1793 ~ "Wilson",
        TRUE ~ NA_character_),
      county_sd = case_when(
        cty_sd_v2_8e86fa == 1652 ~ "Deuel",
        cty_sd_v2_8e86fa == 1657 ~ "Faulk",
        cty_sd_v2_8e86fa == 1674 ~ "Lincoln",
        cty_sd_v2_8e86fa == 1682 ~ "Minnehaha",
        cty_sd_v2_8e86fa == 1696 ~ "Union",
        TRUE ~ NA_character_),
      county_sc = case_when(
        cty_sc_v2_f48d96 == 1 ~ "Abbeville",
        cty_sc_v2_f48d96 == 1590 ~ "Aiken",
        cty_sc_v2_f48d96 == 1592 ~ "Anderson",
        cty_sc_v2_f48d96 == 1594 ~ "Barnwell",
        cty_sc_v2_f48d96 == 1595 ~ "Beaufort",
        cty_sc_v2_f48d96 == 1596 ~ "Berkeley",
        cty_sc_v2_f48d96 == 1598 ~ "Charleston",
        cty_sc_v2_f48d96 == 1599 ~ "Cherokee",
        cty_sc_v2_f48d96 == 1602 ~ "Clarendon",
        cty_sc_v2_f48d96 == 1605 ~ "Dillon",
        cty_sc_v2_f48d96 == 1606 ~ "Dorchester",
        cty_sc_v2_f48d96 == 1608 ~ "Fairfield",
        cty_sc_v2_f48d96 == 1609 ~ "Florence",
        cty_sc_v2_f48d96 == 1610 ~ "Georgetown",
        cty_sc_v2_f48d96 == 1611 ~ "Greenville",
        cty_sc_v2_f48d96 == 1612 ~ "Greenwood",
        cty_sc_v2_f48d96 == 1614 ~ "Horry",
        cty_sc_v2_f48d96 == 1620 ~ "Lexington",
        cty_sc_v2_f48d96 == 1625 ~ "Oconee",
        cty_sc_v2_f48d96 == 1626 ~ "Orangeburg",
        cty_sc_v2_f48d96 == 1628 ~ "Richland",
        cty_sc_v2_f48d96 == 1630 ~ "Spartanburg",
        cty_sc_v2_f48d96 == 1631 ~ "Sumter",
        cty_sc_v2_f48d96 == 1634 ~ "York",
        TRUE ~ NA_character_),
      county_ri = case_when(
        cty_ri_v2_04dfa5 == 1586 ~ "Kent",
        cty_ri_v2_04dfa5 == 1587 ~ "Newport",
        cty_ri_v2_04dfa5 == 1588 ~ "Providence",
        cty_ri_v2_04dfa5 == 1589 ~ "Washington",
        TRUE ~ NA_character_),
      county_pa = case_when(
        cty_pa_v2_73e5b9 == 1 ~ "Adams",
        cty_pa_v2_73e5b9 == 1520 ~ "Allegheny",
        cty_pa_v2_73e5b9 == 1521 ~ "Armstrong",
        cty_pa_v2_73e5b9 == 1522 ~ "Beaver",
        cty_pa_v2_73e5b9 == 1524 ~ "Berks",
        cty_pa_v2_73e5b9 == 1525 ~ "Blair",
        cty_pa_v2_73e5b9 == 1526 ~ "Bradford",
        cty_pa_v2_73e5b9 == 1527 ~ "Bucks",
        cty_pa_v2_73e5b9 == 1528 ~ "Butler",
        cty_pa_v2_73e5b9 == 1529 ~ "Cambria",
        cty_pa_v2_73e5b9 == 1530 ~ "Cameron",
        cty_pa_v2_73e5b9 == 1533 ~ "Chester",
        cty_pa_v2_73e5b9 == 1534 ~ "Clarion",
        cty_pa_v2_73e5b9 == 1535 ~ "Clearfield",
        cty_pa_v2_73e5b9 == 1536 ~ "Clinton",
        cty_pa_v2_73e5b9 == 1538 ~ "Crawford",
        cty_pa_v2_73e5b9 == 1539 ~ "Cumberland",
        cty_pa_v2_73e5b9 == 1540 ~ "Dauphin",
        cty_pa_v2_73e5b9 == 1541 ~ "Delaware",
        cty_pa_v2_73e5b9 == 1543 ~ "Erie",
        cty_pa_v2_73e5b9 == 1544 ~ "Fayette",
        cty_pa_v2_73e5b9 == 1551 ~ "Jefferson",
        cty_pa_v2_73e5b9 == 1553 ~ "Lackawanna",
        cty_pa_v2_73e5b9 == 1554 ~ "Lancaster",
        cty_pa_v2_73e5b9 == 1556 ~ "Lebanon",
        cty_pa_v2_73e5b9 == 1557 ~ "Lehigh",
        cty_pa_v2_73e5b9 == 1558 ~ "Luzerne",
        cty_pa_v2_73e5b9 == 1559 ~ "Lycoming",
        cty_pa_v2_73e5b9 == 1561 ~ "Mercer",
        cty_pa_v2_73e5b9 == 1563 ~ "Monroe",
        cty_pa_v2_73e5b9 == 1564 ~ "Montgomery",
        cty_pa_v2_73e5b9 == 1566 ~ "Northampton",
        cty_pa_v2_73e5b9 == 1569 ~ "Philadelphia",
        cty_pa_v2_73e5b9 == 1570 ~ "Pike",
        cty_pa_v2_73e5b9 == 1572 ~ "Schuylkill",
        cty_pa_v2_73e5b9 == 1573 ~ "Snyder",
        cty_pa_v2_73e5b9 == 1579 ~ "Venango",
        cty_pa_v2_73e5b9 == 1581 ~ "Washington",
        cty_pa_v2_73e5b9 == 1582 ~ "Wayne",
        cty_pa_v2_73e5b9 == 1583 ~ "Westmoreland",
        cty_pa_v2_73e5b9 == 1584 ~ "Wyoming",
        cty_pa_v2_73e5b9 == 1585 ~ "York",
        TRUE ~ NA_character_),
      county_or = case_when(
        cty_or_v2_1c1add == 1 ~ "Baker",
        cty_or_v2_1c1add == 1485 ~ "Benton",
        cty_or_v2_1c1add == 1486 ~ "Clackamas",
        cty_or_v2_1c1add == 1487 ~ "Clatsop",
        cty_or_v2_1c1add == 1489 ~ "Coos",
        cty_or_v2_1c1add == 1491 ~ "Curry",
        cty_or_v2_1c1add == 1492 ~ "Deschutes",
        cty_or_v2_1c1add == 1498 ~ "Jackson",
        cty_or_v2_1c1add == 1501 ~ "Klamath",
        cty_or_v2_1c1add == 1503 ~ "Lane",
        cty_or_v2_1c1add == 1504 ~ "Lincoln",
        cty_or_v2_1c1add == 1507 ~ "Marion",
        cty_or_v2_1c1add == 1509 ~ "Multnomah",
        cty_or_v2_1c1add == 1510 ~ "Polk",
        cty_or_v2_1c1add == 1515 ~ "Wallowa",
        cty_or_v2_1c1add == 1517 ~ "Washington",
        TRUE ~ NA_character_),
      county_ok = case_when(
        cty_ok_v2_eb98bf == 1412 ~ "Beckham",
        cty_ok_v2_eb98bf == 1416 ~ "Canadian",
        cty_ok_v2_eb98bf == 1418 ~ "Cherokee",
        cty_ok_v2_eb98bf == 1419 ~ "Choctaw",
        cty_ok_v2_eb98bf == 1421 ~ "Cleveland",
        cty_ok_v2_eb98bf == 1426 ~ "Creek",
        cty_ok_v2_eb98bf == 1433 ~ "Grady",
        cty_ok_v2_eb98bf == 1443 ~ "Kay",
        cty_ok_v2_eb98bf == 1462 ~ "Oklahoma",
        cty_ok_v2_eb98bf == 1464 ~ "Osage",
        cty_ok_v2_eb98bf == 1467 ~ "Payne",
        cty_ok_v2_eb98bf == 1471 ~ "Pushmataha",
        cty_ok_v2_eb98bf == 1479 ~ "Tulsa",
        cty_ok_v2_eb98bf == 1480 ~ "Wagoner",
        cty_ok_v2_eb98bf == 1482 ~ "Washita",
        TRUE ~ NA_character_),
      county_oh = case_when(
        cty_oh_v2_e7c461 == 1 ~ "Adams",
        cty_oh_v2_e7c461 == 1323 ~ "Ashland",
        cty_oh_v2_e7c461 == 1324 ~ "Ashtabula",
        cty_oh_v2_e7c461 == 1325 ~ "Athens",
        cty_oh_v2_e7c461 == 1327 ~ "Belmont",
        cty_oh_v2_e7c461 == 1329 ~ "Butler",
        cty_oh_v2_e7c461 == 1330 ~ "Carroll",
        cty_oh_v2_e7c461 == 1333 ~ "Clermont",
        cty_oh_v2_e7c461 == 1334 ~ "Clinton",
        cty_oh_v2_e7c461 == 1335 ~ "Columbiana",
        cty_oh_v2_e7c461 == 1338 ~ "Cuyahoga",
        cty_oh_v2_e7c461 == 1341 ~ "Delaware County, Ohio",
        cty_oh_v2_e7c461 == 1343 ~ "Fairfield",
        cty_oh_v2_e7c461 == 1345 ~ "Franklin",
        cty_oh_v2_e7c461 == 1346 ~ "Fulton",
        cty_oh_v2_e7c461 == 1349 ~ "Greene",
        cty_oh_v2_e7c461 == 1351 ~ "Hamilton",
        cty_oh_v2_e7c461 == 1352 ~ "Hancock",
        cty_oh_v2_e7c461 == 1357 ~ "Hocking",
        cty_oh_v2_e7c461 == 1360 ~ "Jackson",
        cty_oh_v2_e7c461 == 1361 ~ "Jefferson",
        cty_oh_v2_e7c461 == 1363 ~ "Lake",
        cty_oh_v2_e7c461 == 1365 ~ "Licking",
        cty_oh_v2_e7c461 == 1367 ~ "Lorain",
        cty_oh_v2_e7c461 == 1368 ~ "Lucas",
        cty_oh_v2_e7c461 == 1369 ~ "Madison",
        cty_oh_v2_e7c461 == 1370 ~ "Mahoning",
        cty_oh_v2_e7c461 == 1371 ~ "Marion",
        cty_oh_v2_e7c461 == 1372 ~ "Medina",
        cty_oh_v2_e7c461 == 1377 ~ "Montgomery",
        cty_oh_v2_e7c461 == 1380 ~ "Muskingum",
        cty_oh_v2_e7c461 == 1382 ~ "Ottawa",
        cty_oh_v2_e7c461 == 1383 ~ "Paulding",
        cty_oh_v2_e7c461 == 1387 ~ "Portage",
        cty_oh_v2_e7c461 == 1390 ~ "Richland",
        cty_oh_v2_e7c461 == 1391 ~ "Ross",
        cty_oh_v2_e7c461 == 1393 ~ "Scioto",
        cty_oh_v2_e7c461 == 1394 ~ "Seneca",
        cty_oh_v2_e7c461 == 1395 ~ "Shelby",
        cty_oh_v2_e7c461 == 1396 ~ "Stark",
        cty_oh_v2_e7c461 == 1397 ~ "Summit",
        cty_oh_v2_e7c461 == 1398 ~ "Trumbull",
        cty_oh_v2_e7c461 == 1399 ~ "Tuscarawas",
        cty_oh_v2_e7c461 == 1403 ~ "Warren",
        cty_oh_v2_e7c461 == 1404 ~ "Washington",
        TRUE ~ NA_character_),
      county_vt = case_when(
        cty_vt_v2_74ef52 == 1 ~ "Addison",
        cty_vt_v2_74ef52 == 2075 ~ "Bennington",
        cty_vt_v2_74ef52 == 2077 ~ "Chittenden",
        cty_vt_v2_74ef52 == 2079 ~ "Franklin",
        cty_vt_v2_74ef52 == 2084 ~ "Rutland",
        cty_vt_v2_74ef52 == 2085 ~ "Washington",
        cty_vt_v2_74ef52 == 2087 ~ "Windsor",
        TRUE ~ NA_character_),
      county_va = case_when(
        cty_va_v2_ab6104 == 1 ~ "Accomack",
        cty_va_v2_ab6104 == 2088 ~ "Albemarle",
        cty_va_v2_ab6104 == 2089 ~ "Alexandria",
        cty_va_v2_ab6104 == 2091 ~ "Amelia",
        cty_va_v2_ab6104 == 2092 ~ "Amherst",
        cty_va_v2_ab6104 == 2094 ~ "Arlington",
        cty_va_v2_ab6104 == 2095 ~ "Augusta",
        cty_va_v2_ab6104 == 2097 ~ "Bedford",
        cty_va_v2_ab6104 == 2100 ~ "Bristol",
        cty_va_v2_ab6104 == 2101 ~ "Brunswick",
        cty_va_v2_ab6104 == 2103 ~ "Buckingham",
        cty_va_v2_ab6104 == 2106 ~ "Caroline",
        cty_va_v2_ab6104 == 2108 ~ "Charles City",
        cty_va_v2_ab6104 == 2109 ~ "Charlotte",
        cty_va_v2_ab6104 == 2110 ~ "Charlottesville",
        cty_va_v2_ab6104 == 2111 ~ "Chesapeake city",
        cty_va_v2_ab6104 == 2112 ~ "Chesterfield",
        cty_va_v2_ab6104 == 2121 ~ "Dinwiddie",
        cty_va_v2_ab6104 == 2124 ~ "Fairfax",
        cty_va_v2_ab6104 == 2127 ~ "Fauquier",
        cty_va_v2_ab6104 == 2132 ~ "Frederick",
        cty_va_v2_ab6104 == 2142 ~ "Hampton",
        cty_va_v2_ab6104 == 2143 ~ "Hanover",
        cty_va_v2_ab6104 == 2145 ~ "Henrico",
        cty_va_v2_ab6104 == 2148 ~ "Hopewell",
        cty_va_v2_ab6104 == 2152 ~ "King George",
        cty_va_v2_ab6104 == 2154 ~ "Lancaster",
        cty_va_v2_ab6104 == 2157 ~ "Loudoun",
        cty_va_v2_ab6104 == 2159 ~ "Lunenburg",
        cty_va_v2_ab6104 == 2169 ~ "Nelson",
        cty_va_v2_ab6104 == 2171 ~ "Newport News",
        cty_va_v2_ab6104 == 2172 ~ "Norfolk city",
        cty_va_v2_ab6104 == 2176 ~ "Nottoway",
        cty_va_v2_ab6104 == 2180 ~ "Petersburg",
        cty_va_v2_ab6104 == 2181 ~ "Pittsylvania",
        cty_va_v2_ab6104 == 2183 ~ "Portsmouth",
        cty_va_v2_ab6104 == 2184 ~ "Powhatan",
        cty_va_v2_ab6104 == 2185 ~ "Prince Edward",
        cty_va_v2_ab6104 == 2187 ~ "Prince William",
        cty_va_v2_ab6104 == 2189 ~ "Radford",
        cty_va_v2_ab6104 == 2190 ~ "Rappahannock",
        cty_va_v2_ab6104 == 2191 ~ "Richmond",
        cty_va_v2_ab6104 == 2192 ~ "Richmond city",
        cty_va_v2_ab6104 == 2193 ~ "Roanoke",
        cty_va_v2_ab6104 == 2195 ~ "Rockbridge",
        cty_va_v2_ab6104 == 2196 ~ "Rockingham",
        cty_va_v2_ab6104 == 2200 ~ "Shenandoah",
        cty_va_v2_ab6104 == 2201 ~ "Smyth",
        cty_va_v2_ab6104 == 2203 ~ "Spotsylvania",
        cty_va_v2_ab6104 == 2204 ~ "Stafford",
        cty_va_v2_ab6104 == 2206 ~ "Suffolk",
        cty_va_v2_ab6104 == 2209 ~ "Tazewell",
        cty_va_v2_ab6104 == 2210 ~ "Virginia Beach city",
        cty_va_v2_ab6104 == 2212 ~ "Washington",
        cty_va_v2_ab6104 == 2216 ~ "Winchester",
        cty_va_v2_ab6104 == 2219 ~ "York",
        TRUE ~ NA_character_),
      county_wa = case_when(
        cty_wa_v2_ee038c == 1 ~ "Adams",
        cty_wa_v2_ee038c == 2221 ~ "Benton",
        cty_wa_v2_ee038c == 2224 ~ "Clark",
        cty_wa_v2_ee038c == 2225 ~ "Columbia",
        cty_wa_v2_ee038c == 2226 ~ "Cowlitz",
        cty_wa_v2_ee038c == 2231 ~ "Grant",
        cty_wa_v2_ee038c == 2233 ~ "Island",
        cty_wa_v2_ee038c == 2234 ~ "Jefferson",
        cty_wa_v2_ee038c == 2235 ~ "King",
        cty_wa_v2_ee038c == 2236 ~ "Kitsap",
        cty_wa_v2_ee038c == 2239 ~ "Lewis",
        cty_wa_v2_ee038c == 2240 ~ "Lincoln",
        cty_wa_v2_ee038c == 2245 ~ "Pierce",
        cty_wa_v2_ee038c == 2247 ~ "Skagit",
        cty_wa_v2_ee038c == 2249 ~ "Snohomish",
        cty_wa_v2_ee038c == 2250 ~ "Spokane",
        cty_wa_v2_ee038c == 2252 ~ "Thurston",
        cty_wa_v2_ee038c == 2254 ~ "Walla Walla",
        cty_wa_v2_ee038c == 2255 ~ "Whatcom",
        cty_wa_v2_ee038c == 2256 ~ "Whitman",
        cty_wa_v2_ee038c == 2257 ~ "Yakima",
        TRUE ~ NA_character_),
      county_wv = case_when(
        cty_wv_v2_1d9ac9 == 2258 ~ "Berkeley",
        cty_wv_v2_1d9ac9 == 2264 ~ "Clay",
        cty_wv_v2_1d9ac9 == 2266 ~ "Fayette",
        cty_wv_v2_1d9ac9 == 2274 ~ "Jackson",
        cty_wv_v2_1d9ac9 == 2276 ~ "Kanawha",
        cty_wv_v2_1d9ac9 == 2280 ~ "Marion",
        cty_wv_v2_1d9ac9 == 2284 ~ "Mercer",
        cty_wv_v2_1d9ac9 == 2287 ~ "Monongalia",
        cty_wv_v2_1d9ac9 == 2295 ~ "Preston",
        cty_wv_v2_1d9ac9 == 2296 ~ "Putnam",
        cty_wv_v2_1d9ac9 == 2310 ~ "Wood",
        TRUE ~ NA_character_),
      county_wi = case_when(
        cty_wi_v2_950d32 == 2315 ~ "Brown",
        cty_wi_v2_950d32 == 2317 ~ "Burnett",
        cty_wi_v2_950d32 == 2319 ~ "Chippewa",
        cty_wi_v2_950d32 == 2321 ~ "Columbia",
        cty_wi_v2_950d32 == 2323 ~ "Dane",
        cty_wi_v2_950d32 == 2325 ~ "Door",
        cty_wi_v2_950d32 == 2330 ~ "Fond du Lac",
        cty_wi_v2_950d32 == 2332 ~ "Grant",
        cty_wi_v2_950d32 == 2337 ~ "Jackson",
        cty_wi_v2_950d32 == 2342 ~ "La Crosse",
        cty_wi_v2_950d32 == 2346 ~ "Manitowoc",
        cty_wi_v2_950d32 == 2347 ~ "Marathon",
        cty_wi_v2_950d32 == 2348 ~ "Marinette",
        cty_wi_v2_950d32 == 2351 ~ "Milwaukee",
        cty_wi_v2_950d32 == 2352 ~ "Monroe",
        cty_wi_v2_950d32 == 2356 ~ "Ozaukee",
        cty_wi_v2_950d32 == 2359 ~ "Polk",
        cty_wi_v2_950d32 == 2362 ~ "Racine",
        cty_wi_v2_950d32 == 2364 ~ "Rock",
        cty_wi_v2_950d32 == 2366 ~ "Sauk",
        cty_wi_v2_950d32 == 2368 ~ "Shawano",
        cty_wi_v2_950d32 == 2375 ~ "Walworth",
        cty_wi_v2_950d32 == 2377 ~ "Washington",
        cty_wi_v2_950d32 == 2378 ~ "Waukesha",
        cty_wi_v2_950d32 == 2381 ~ "Winnebago",
        TRUE ~ NA_character_),
      county_wy = case_when(
        cty_wy_v2_ac720c == 4 ~ "Carbon",
        cty_wy_v2_ac720c == 5 ~ "Converse",
        cty_wy_v2_ac720c == 11 ~ "Laramie",
        cty_wy_v2_ac720c == 13 ~ "Natrona",
        cty_wy_v2_ac720c == 19 ~ "Sweetwater",
        cty_wy_v2_ac720c == 21 ~ "Uinta",
        TRUE ~ NA_character_),
      county_pr = case_when(
        cty_pr_v2_a67c59 == 106 ~ "Yauco Municipio, Puerto Rico",
        TRUE ~ NA_character_),
      county_minor = case_when(
        cty_minor_v2_0217db == 1 ~ "Baker Island",
        TRUE ~ NA_character_),
      county_vi = case_when(
        cty_vi_v2_941d0b == 115 ~ "St. John",
        cty_vi_v2_941d0b == 116 ~ "St. Thomas",
        TRUE ~ NA_character_),
      county_gu = case_when(
        !is.na(cty_gu_v2_d42386) ~ NA_character_,
        TRUE ~ NA_character_),
      .keep = "unused")

# county cols needs to be defined separately, it seems, for county & state merge
county_cols <- syms(grep("^county_", names(dat), value = TRUE))
dat <- dat |>
  mutate(
    countyName = coalesce(!!!county_cols),
    countyName = gsub(", Ohio$", "", countyName),
    location = if_else(
      !is.na(countyName) & !is.na(state),
      paste0(countyName, ", ", state),
      NA_character_)) |>
  select(-starts_with("county_")) |>
  rename(county_name = countyName) |>
  mutate(
    # First remove the parenthetical expressions entirely
    location = gsub("\\s*\\(\\d*\\)", "", location),
    # Then ensure the state code is just the 2-letter abbreviation
    location = gsub("(, [A-Z]{2})\\d+$", "\\1", location)) |>
  mutate(location = case_when(
    location == "Anchorage Municipality, AK" ~ "Anchorage, AK",
    location == "Juneau City and Borough, AK" ~ "Juneau, AK",
    location == "Kenai Peninsula Borough, AK" ~ "Kenai Peninsula, AK",
    location == "Matanuska-Susitna Borough, AK" ~ "Matanuska-Susitna, AK",
    TRUE ~ location)) |> 
# remove some unnecessary things
  select(-c(redcap_event_name, protein_1, protein_2, protein_3),
        -contains("pen"),
         -contains("clothes"), -contains("time_end"),
           -contains("shirt"))

# length of time to finish survey 
dat <- dat |>
  mutate(
    arm_1_timestamp  = if_else(arm_1_timestamp == "", NA_character_, arm_1_timestamp),
    arm_2_timestamp = if_else(arm_2_timestamp == "", NA_character_, arm_2_timestamp),
    arm_3_timestamp = if_else(arm_3_timestamp == "", NA_character_, arm_3_timestamp),
    merged_timestamp = coalesce(arm_1_timestamp, arm_2_timestamp, arm_3_timestamp)
  ) |>  
  mutate(
    merged_timestamp = as.POSIXct(merged_timestamp, format="%Y-%m-%d %H:%M:%S"),
    stanford_survey_4_timestamp = as.POSIXct(stanford_survey_4_timestamp, format="%Y-%m-%d %H:%M:%S"),
    time_elapsed = difftime(stanford_survey_4_timestamp, merged_timestamp, units = "secs")) |> 
  select(-starts_with('Stanford'))
  # Dairy consumption check

# one var for 'complete
dat <- dat |> mutate(complete = coalesce(arm_1_complete, arm_2_complete, arm_3_complete),
                     .keep = "unused")

# reorder for readability & remove a few record-keeping things
dat <- dat |>
  select(-c(arm_1_timestamp, arm_2_timestamp, arm_3_timestamp, merged_timestamp,
            white_rice, brown_rice, black_beans, pinto_beans, fresh_tomato_salsa, 
            roasted_chili_corn, tomatillo_green, tomatillo_red, sour_cream, 
            fajita_veggies, cheese, romaine_lettuce), 
         -contains("complete"),
         -starts_with(c("topp_", "addons_"))) |>
select(record_id, treatment_arm, taco_choice, meat_select,
         chicken_select, age, gender, county_name, state,
         location, everything())

write.csv(dat, './data/cleaned-tacos-data.csv')
